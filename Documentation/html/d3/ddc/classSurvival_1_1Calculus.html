<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>“Survival”: Survival::Calculus Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">“Survival”
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="../../inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../df/d88/namespaceSurvival.html">Survival</a></li><li class="navelem"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html">Calculus</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d5/d25/classSurvival_1_1Calculus-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Survival::Calculus Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>It implements some methods to simulate the irradiation process evaluating the cellular survival on a population of cells and extrapolating the radiobiological LQ parameters.  
 <a href="../../d3/ddc/classSurvival_1_1Calculus.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d3/de2/Calculus_8h_source.html">Calculus.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for Survival::Calculus:</div>
<div class="dyncontent">
<div class="center"><img src="../../d8/d50/classSurvival_1_1Calculus__coll__graph.png" border="0" usemap="#Survival_1_1Calculus_coll__map" alt="Collaboration graph"/></div>
<map name="Survival_1_1Calculus_coll__map" id="Survival_1_1Calculus_coll__map">
<area shape="rect" id="node2" href="../../d3/d56/classSurvival_1_1CellLine.html" title="Represents the cell line to which the nucleus belongs and hosts the radiobiological and structural ch..." alt="" coords="167,147,383,621"/><area shape="rect" id="node4" href="../../dd/d54/classSurvival_1_1Tracks.html" title="This is a container class for Track objects; it implements the structure and methods to manage a vect..." alt="" coords="408,265,571,503"/><area shape="rect" id="node5" href="../../d3/d6c/classSurvival_1_1Nucleus.html" title="Linked to a specific CellLine object, this class defines the structure of the cellular nucleus to be ..." alt="" coords="596,272,759,496"/></map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8a305247a6ee3a9610ffc4f0273b6ddb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a8a305247a6ee3a9610ffc4f0273b6ddb">Calculus</a> (const <a class="el" href="../../dd/d54/classSurvival_1_1Tracks.html">Tracks</a> &amp;tracksRef, const <a class="el" href="../../d3/d56/classSurvival_1_1CellLine.html">CellLine</a> &amp;cellLineRef, <a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html">Nucleus</a> &amp;nucleusRef, std::string <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae41fc7fc62ad55b23e6c956243af265a">savePrefix</a>, std::string <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a3bc1ee3d082af310885da70c38f1f69a">model</a>, int p_type=1, long randomSeed=0)</td></tr>
<tr class="memdesc:a8a305247a6ee3a9610ffc4f0273b6ddb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor. Instantiates and sets the object.  <a href="#a8a305247a6ee3a9610ffc4f0273b6ddb">More...</a><br/></td></tr>
<tr class="separator:a8a305247a6ee3a9610ffc4f0273b6ddb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae98174e438b83acfe4afc3e283890ce8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae98174e438b83acfe4afc3e283890ce8">~Calculus</a> ()</td></tr>
<tr class="memdesc:ae98174e438b83acfe4afc3e283890ce8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#ae98174e438b83acfe4afc3e283890ce8">More...</a><br/></td></tr>
<tr class="separator:ae98174e438b83acfe4afc3e283890ce8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6fbdc8ae32e5741260528c141a2cdd4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ab6fbdc8ae32e5741260528c141a2cdd4">getNThreads</a> (void) const </td></tr>
<tr class="memdesc:ab6fbdc8ae32e5741260528c141a2cdd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the number of threads used in the simulation.  <a href="#ab6fbdc8ae32e5741260528c141a2cdd4">More...</a><br/></td></tr>
<tr class="separator:ab6fbdc8ae32e5741260528c141a2cdd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3f0e540feb07414181a3ddc9a5dc289"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#aa3f0e540feb07414181a3ddc9a5dc289">generateSequence</a> (int nEv, double begin, double duration)</td></tr>
<tr class="memdesc:aa3f0e540feb07414181a3ddc9a5dc289"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate an ordered fixed-size sequence of pseudorandom numbers in [begin, begin+duration].  <a href="#aa3f0e540feb07414181a3ddc9a5dc289">More...</a><br/></td></tr>
<tr class="separator:aa3f0e540feb07414181a3ddc9a5dc289"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff1c83dcc7dd667e86e3b08f17db6efe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#aff1c83dcc7dd667e86e3b08f17db6efe">evaluateG</a> (const std::string trackMode, double totalDose, int nFrac, double timeSpacing, double fracDeliveryTime, double precision, double alpha, double beta)</td></tr>
<tr class="memdesc:aff1c83dcc7dd667e86e3b08f17db6efe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a Monte Carlo simulation delivering a fixed total dose with a defined time structure to a cell population, evaluating the resulting cell survival in order to get the value of the G factor that defines the temporal effect of the irradiation.  <a href="#aff1c83dcc7dd667e86e3b08f17db6efe">More...</a><br/></td></tr>
<tr class="separator:aff1c83dcc7dd667e86e3b08f17db6efe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f5dbb4c4c72cba8dacd883b65fc8d61"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a7f5dbb4c4c72cba8dacd883b65fc8d61">getModel</a> () const </td></tr>
<tr class="memdesc:a7f5dbb4c4c72cba8dacd883b65fc8d61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the model used in the simulation.  <a href="#a7f5dbb4c4c72cba8dacd883b65fc8d61">More...</a><br/></td></tr>
<tr class="separator:a7f5dbb4c4c72cba8dacd883b65fc8d61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5f1ea95674d3f9325cccc91d1469660"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae5f1ea95674d3f9325cccc91d1469660">histogram_dose_survival_p</a> (const double doseImposed, double &amp;dose, double &amp;doseUncertainty, double &amp;survival, double &amp;survivalUncertainty, <a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html">Nucleus</a> &amp;nuc_cp, bool clean=true)</td></tr>
<tr class="memdesc:ae5f1ea95674d3f9325cccc91d1469660"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cellular population.  <a href="#ae5f1ea95674d3f9325cccc91d1469660">More...</a><br/></td></tr>
<tr class="separator:ae5f1ea95674d3f9325cccc91d1469660"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa500fd3a7915675ca3f53cf16c4374f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#aa500fd3a7915675ca3f53cf16c4374f3">histogram_dose_survival_t</a> (<a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html">Nucleus</a> &amp;nuc_cp, const double doseImposed, const double time, const double fracDeliveryTime)</td></tr>
<tr class="memdesc:aa500fd3a7915675ca3f53cf16c4374f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulates via the Monte Carlo method the irradiation process of a nucleus, which is part of the cellular population, in a single fraction with a defined duration.  <a href="#aa500fd3a7915675ca3f53cf16c4374f3">More...</a><br/></td></tr>
<tr class="separator:aa500fd3a7915675ca3f53cf16c4374f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47538c45fd5a9b2cd97bea6d41341171"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a47538c45fd5a9b2cd97bea6d41341171">histogram_dose_survival_with_domains</a> (const double doseImposed, double &amp;dose, double &amp;doseUncertainty, double &amp;survival, double &amp;survivalUncertainty, std::vector&lt; double &gt; &amp;doses, std::vector&lt; double &gt; &amp;lethals, std::vector&lt; double &gt; &amp;dosesUncertainty, std::vector&lt; double &gt; &amp;lethalsUncertainty, bool clean=true)</td></tr>
<tr class="memdesc:a47538c45fd5a9b2cd97bea6d41341171"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cellular population. This function was thought to control the dose delivery inside the MKM nucleus. It's similar to histogram_dose_survival() but provide also informations on the microscopic dose deposition pattern in each domain of the nucleus.  <a href="#a47538c45fd5a9b2cd97bea6d41341171">More...</a><br/></td></tr>
<tr class="separator:a47538c45fd5a9b2cd97bea6d41341171"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a294fab8fab79c18b557029728c222150"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a294fab8fab79c18b557029728c222150">random_dose_survival_p</a> (const double doseImposed, double &amp;dose, double &amp;doseUncertainty, double &amp;survival, double &amp;survivalUncertainty, <a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html">Nucleus</a> &amp;nuc_cp, bool clean=true)</td></tr>
<tr class="memdesc:a294fab8fab79c18b557029728c222150"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cellular population.  <a href="#a294fab8fab79c18b557029728c222150">More...</a><br/></td></tr>
<tr class="separator:a294fab8fab79c18b557029728c222150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb67296b683897b7af5ced335b695a23"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#adb67296b683897b7af5ced335b695a23">rapidINFN_alphaIon_betaIon</a> (double &amp;alphaIon, double &amp;betaIon)</td></tr>
<tr class="memdesc:adb67296b683897b7af5ced335b695a23"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method was developed to improve both the <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> and <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/> estimation with respect to the approach of Scholz. It is currently applicable to the LEM I version only (the possibility of extending the approach to the subsequent versions is under investigation).  <a href="#adb67296b683897b7af5ced335b695a23">More...</a><br/></td></tr>
<tr class="separator:adb67296b683897b7af5ced335b695a23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5d0c2ac1627f5f09be324e8f22f5e49"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae5d0c2ac1627f5f09be324e8f22f5e49">rapidMKM_Hawkins_alphaIon_betaIon</a> (double &amp;alphaIon, double &amp;betaIon)</td></tr>
<tr class="memdesc:ae5d0c2ac1627f5f09be324e8f22f5e49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Different implementation of the rapidMKM calculation.  <a href="#ae5d0c2ac1627f5f09be324e8f22f5e49">More...</a><br/></td></tr>
<tr class="separator:ae5d0c2ac1627f5f09be324e8f22f5e49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25393348b530b7d5ef5146181a930b08"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a25393348b530b7d5ef5146181a930b08">rapidMKM_Kase_alphaIon_betaIon</a> (double &amp;alphaIon, double &amp;betaIon)</td></tr>
<tr class="memdesc:a25393348b530b7d5ef5146181a930b08"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method provide the original analytic implementation of the MKM model, as it is described by Hawkins.  <a href="#a25393348b530b7d5ef5146181a930b08">More...</a><br/></td></tr>
<tr class="separator:a25393348b530b7d5ef5146181a930b08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacf5c74f0c2335627f49f5c2e66a39d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#aacf5c74f0c2335627f49f5c2e66a39d0">rapidRusso_alphaIon_betaIon</a> (double &amp;alphaIon, double &amp;betaIon)</td></tr>
<tr class="memdesc:aacf5c74f0c2335627f49f5c2e66a39d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method is based on the approach of Scholz (<a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a8f34e60d497fee9f958c348a385bc852" title="This method provide a faster approximate implementation of the LEM model that avoids the Monte Carlo ...">rapidScholz_alphaIon_betaIon()</a>) but provides a more precise estimation of the <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> parameter.  <a href="#aacf5c74f0c2335627f49f5c2e66a39d0">More...</a><br/></td></tr>
<tr class="separator:aacf5c74f0c2335627f49f5c2e66a39d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f34e60d497fee9f958c348a385bc852"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a8f34e60d497fee9f958c348a385bc852">rapidScholz_alphaIon_betaIon</a> (double &amp;alphaIon, double &amp;betaIon)</td></tr>
<tr class="memdesc:a8f34e60d497fee9f958c348a385bc852"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method provide a faster approximate implementation of the LEM model that avoids the Monte Carlo simulation.  <a href="#a8f34e60d497fee9f958c348a385bc852">More...</a><br/></td></tr>
<tr class="separator:a8f34e60d497fee9f958c348a385bc852"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60290825861f0f74de61224114b15f96"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a60290825861f0f74de61224114b15f96">setNThreads</a> (int nTh)</td></tr>
<tr class="memdesc:a60290825861f0f74de61224114b15f96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the number of threads.  <a href="#a60290825861f0f74de61224114b15f96">More...</a><br/></td></tr>
<tr class="separator:a60290825861f0f74de61224114b15f96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a532ecb9940306c12f8ca08684057f34e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a532ecb9940306c12f8ca08684057f34e">setSavePrefix</a> (std::string save_prefix)</td></tr>
<tr class="memdesc:a532ecb9940306c12f8ca08684057f34e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the prefix of the output file name.  <a href="#a532ecb9940306c12f8ca08684057f34e">More...</a><br/></td></tr>
<tr class="separator:a532ecb9940306c12f8ca08684057f34e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71a43500a5655346c3b9ac0f687c999f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a71a43500a5655346c3b9ac0f687c999f">slow_alphaIon_betaIon</a> (const std::string trackMode, const std::vector&lt; double &gt; parameters, const std::vector&lt; double &gt; dosesImposed, const double precision, double &amp;alphaIon, double &amp;alphaIonUncertainty, double &amp;betaIon, double &amp;betaIonUncertainty, const int nFraction, const double timeSpacing, const double fracDeliveryTime, const bool saveAlphaBeta, const bool saveMeans, const bool saveCell, const std::string title_means)</td></tr>
<tr class="memdesc:a71a43500a5655346c3b9ac0f687c999f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method called to perform a Monte Carlo simulation to reproduce the irradiation process getting the LQ parameters <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> and <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/>.  <a href="#a71a43500a5655346c3b9ac0f687c999f">More...</a><br/></td></tr>
<tr class="separator:a71a43500a5655346c3b9ac0f687c999f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5354e680ba838228dba9624b1e0a6ca7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a5354e680ba838228dba9624b1e0a6ca7">slow_alphaIon_betaIon_with_Domains</a> (const std::string trackMode, const double minDose, const double maxDose, const int numberOfDoses, const double precision, double &amp;alphaIon, double &amp;alphaIonUncertainty, double &amp;betaIon, double &amp;betaIonUncertainty)</td></tr>
<tr class="memdesc:a5354e680ba838228dba9624b1e0a6ca7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function was thought to control the dose delivery inside the MKM nucleus. It's similar to <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a71a43500a5655346c3b9ac0f687c999f" title="Method called to perform a Monte Carlo simulation to reproduce the irradiation process getting the LQ...">slow_alphaIon_betaIon()</a> but provide also informations on the microscopic dose deposition pattern in each domain of the nucleus.  <a href="#a5354e680ba838228dba9624b1e0a6ca7">More...</a><br/></td></tr>
<tr class="separator:a5354e680ba838228dba9624b1e0a6ca7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7362c07d69d46fa313fd2ca68b88de90"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a7362c07d69d46fa313fd2ca68b88de90">slow_meanDose_meanSurvival</a> (const std::string trackMode, const double doseImposed, const double precision, double &amp;meanDose, double &amp;meanDoseUncertainty, double &amp;meanSurvival, double &amp;meanSurvivalUncertainty, const int nFraction, const double timeSpacing, const double fracDeliveryTime, const bool saveCell)</td></tr>
<tr class="memdesc:a7362c07d69d46fa313fd2ca68b88de90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform the Monte Carlo simulation relatively to a single value of dose imposed and returns the mean values of dose absorbed and survival observed in the cell population.  <a href="#a7362c07d69d46fa313fd2ca68b88de90">More...</a><br/></td></tr>
<tr class="separator:a7362c07d69d46fa313fd2ca68b88de90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac0abf30856195062b94015937838aaf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#aac0abf30856195062b94015937838aaf">slow_meanDose_meanSurvival_with_Domains</a> (const std::string trackMode, const double doseImposed, const double precision, double &amp;meanDose, double &amp;meanDoseUncertainty, double &amp;meanSurvival, double &amp;meanSurvivalUncertainty)</td></tr>
<tr class="memdesc:aac0abf30856195062b94015937838aaf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform the Monte Carlo simulation relatively to a single value of dose imposed and returns the mean values of dose absorbed and survival observed in the cell population. This function was thought to control the dose delivery inside the MKM nucleus. It's similar to <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a7362c07d69d46fa313fd2ca68b88de90" title="Perform the Monte Carlo simulation relatively to a single value of dose imposed and returns the mean ...">slow_meanDose_meanSurvival()</a> but provide also informations on the microscopic dose deposition pattern in each domain of the nucleus.  <a href="#aac0abf30856195062b94015937838aaf">More...</a><br/></td></tr>
<tr class="separator:aac0abf30856195062b94015937838aaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1303a07d2edc29d56b313eeac9c16a62"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a1303a07d2edc29d56b313eeac9c16a62">verbatim_dose_survival</a> (double &amp;dose, double &amp;doseUncertainty, double &amp;survival, double &amp;survivalUncertainty, bool clean=true)</td></tr>
<tr class="memdesc:a1303a07d2edc29d56b313eeac9c16a62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates the dose deposited in the nucleus using directly the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae9cc5cb2e186827348372eeb058890fe" title="A const reference to a Track object corresponding to the Particle interacting with nucleus...">tracks</a> vector without modifying it and without random numbers extractions.  <a href="#a1303a07d2edc29d56b313eeac9c16a62">More...</a><br/></td></tr>
<tr class="separator:a1303a07d2edc29d56b313eeac9c16a62"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ae9cc5cb2e186827348372eeb058890fe"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../dd/d54/classSurvival_1_1Tracks.html">Tracks</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae9cc5cb2e186827348372eeb058890fe">tracks</a></td></tr>
<tr class="memdesc:ae9cc5cb2e186827348372eeb058890fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">A <code>const</code> reference to a <a class="el" href="../../d3/d4c/classSurvival_1_1Track.html" title="Constructed on the base of an ion Particle object, this class represents the local dose distribution ...">Track</a> object corresponding to the <a class="el" href="../../d3/d2a/classSurvival_1_1Particle.html" title="This class defines the object &quot;particle&quot;. ">Particle</a> interacting with <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a3960e65eb18f7c3239b8cfe9cd877cf3" title="A reference to the cellular nucleus. ">nucleus</a>.  <a href="#ae9cc5cb2e186827348372eeb058890fe">More...</a><br/></td></tr>
<tr class="separator:ae9cc5cb2e186827348372eeb058890fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77c5837150fee7a4e02a26d301df8564"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d3/d56/classSurvival_1_1CellLine.html">CellLine</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a77c5837150fee7a4e02a26d301df8564">cellLine</a></td></tr>
<tr class="memdesc:a77c5837150fee7a4e02a26d301df8564"><td class="mdescLeft">&#160;</td><td class="mdescRight">A <code>const</code> reference to a <a class="el" href="../../d3/d56/classSurvival_1_1CellLine.html" title="Represents the cell line to which the nucleus belongs and hosts the radiobiological and structural ch...">CellLine</a> object corresponding to the cell line to which the nucleus belongs.  <a href="#a77c5837150fee7a4e02a26d301df8564">More...</a><br/></td></tr>
<tr class="separator:a77c5837150fee7a4e02a26d301df8564"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3960e65eb18f7c3239b8cfe9cd877cf3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html">Nucleus</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a3960e65eb18f7c3239b8cfe9cd877cf3">nucleus</a></td></tr>
<tr class="memdesc:a3960e65eb18f7c3239b8cfe9cd877cf3"><td class="mdescLeft">&#160;</td><td class="mdescRight">A reference to the cellular nucleus.  <a href="#a3960e65eb18f7c3239b8cfe9cd877cf3">More...</a><br/></td></tr>
<tr class="separator:a3960e65eb18f7c3239b8cfe9cd877cf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ffcf267836a8c9427b0b1012d3fb9e6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a3ffcf267836a8c9427b0b1012d3fb9e6">nThreads</a></td></tr>
<tr class="memdesc:a3ffcf267836a8c9427b0b1012d3fb9e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of threads needed to be used in the simulation (if parallelism is supported).  <a href="#a3ffcf267836a8c9427b0b1012d3fb9e6">More...</a><br/></td></tr>
<tr class="separator:a3ffcf267836a8c9427b0b1012d3fb9e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52368f19965750ec6eedd7a5eb6e3967"><td class="memItemLeft" align="right" valign="top">gsl_rng *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a52368f19965750ec6eedd7a5eb6e3967">randomGenerator</a></td></tr>
<tr class="memdesc:a52368f19965750ec6eedd7a5eb6e3967"><td class="mdescLeft">&#160;</td><td class="mdescRight">A pointer to a gsl_rng object, useful in the generation of pseudorandom numbers in the Monte Carlo simulation.  <a href="#a52368f19965750ec6eedd7a5eb6e3967">More...</a><br/></td></tr>
<tr class="separator:a52368f19965750ec6eedd7a5eb6e3967"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae41fc7fc62ad55b23e6c956243af265a"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae41fc7fc62ad55b23e6c956243af265a">savePrefix</a></td></tr>
<tr class="memdesc:ae41fc7fc62ad55b23e6c956243af265a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The prefix of the output file.  <a href="#ae41fc7fc62ad55b23e6c956243af265a">More...</a><br/></td></tr>
<tr class="separator:ae41fc7fc62ad55b23e6c956243af265a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bc1ee3d082af310885da70c38f1f69a"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a3bc1ee3d082af310885da70c38f1f69a">model</a></td></tr>
<tr class="memdesc:a3bc1ee3d082af310885da70c38f1f69a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The model used in the simulation.  <a href="#a3bc1ee3d082af310885da70c38f1f69a">More...</a><br/></td></tr>
<tr class="separator:a3bc1ee3d082af310885da70c38f1f69a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>It implements some methods to simulate the irradiation process evaluating the cellular survival on a population of cells and extrapolating the radiobiological LQ parameters. </p>
<dl class="section author"><dt>Author</dt><dd>Andrea Attili </dd>
<dd>
Lorenzo Manganaro </dd>
<dd>
Germano Russo </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2011&ndash;2015</dd></dl>
<p>The class makes use of <a class="el" href="../../d3/d4c/classSurvival_1_1Track.html" title="Constructed on the base of an ion Particle object, this class represents the local dose distribution ...">Track</a> and <a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html" title="Linked to a specific CellLine object, this class defines the structure of the cellular nucleus to be ...">Nucleus</a> objects to simulate the irradiation process. Different methods are implemented in order to perform Monte Carlo simulations or approximated analytic evaluations of the process. </p>

<p>Definition at line <a class="el" href="../../d3/de2/Calculus_8h_source.html#l00023">23</a> of file <a class="el" href="../../d3/de2/Calculus_8h_source.html">Calculus.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a8a305247a6ee3a9610ffc4f0273b6ddb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Calculus::Calculus </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../dd/d54/classSurvival_1_1Tracks.html">Tracks</a> &amp;&#160;</td>
          <td class="paramname"><em>tracksRef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d3/d56/classSurvival_1_1CellLine.html">CellLine</a> &amp;&#160;</td>
          <td class="paramname"><em>cellLineRef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html">Nucleus</a> &amp;&#160;</td>
          <td class="paramname"><em>nucleusRef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>savePrefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>p_type</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>randomSeed</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. Instantiates and sets the object. </p>
<p>It needs references to <a class="el" href="../../dd/d54/classSurvival_1_1Tracks.html" title="This is a container class for Track objects; it implements the structure and methods to manage a vect...">Tracks</a>, <a class="el" href="../../d3/d56/classSurvival_1_1CellLine.html" title="Represents the cell line to which the nucleus belongs and hosts the radiobiological and structural ch...">CellLine</a> and <a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html" title="Linked to a specific CellLine object, this class defines the structure of the cellular nucleus to be ...">Nucleus</a> objects to be used in the simulation. It needs also the prefix of the output file and provides the possibility to fix the seed of the pseudorandom numbers generator and to manage the number of threads (only necessary for methods that implement a multithread system). The class makes use of the GSL library to manage the generation of pseudorandom numbers, hence an instance of the Tausworthe generator is created and the pseudorandom numbers generator is seeded.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tracksRef</td><td>A reference to a <a class="el" href="../../dd/d54/classSurvival_1_1Tracks.html" title="This is a container class for Track objects; it implements the structure and methods to manage a vect...">Tracks</a> object to manage the radiation. </td></tr>
    <tr><td class="paramname">cellLineRef</td><td>A reference to a <a class="el" href="../../d3/d56/classSurvival_1_1CellLine.html" title="Represents the cell line to which the nucleus belongs and hosts the radiobiological and structural ch...">CellLine</a> object containing the structural and radiobiological informations. </td></tr>
    <tr><td class="paramname">nucleusRef</td><td>A reference to a <a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html" title="Linked to a specific CellLine object, this class defines the structure of the cellular nucleus to be ...">Nucleus</a> object to be irradiated. </td></tr>
    <tr><td class="paramname">savePrefix</td><td>A <code>string</code> indicating the prefix of the output file. </td></tr>
    <tr><td class="paramname">model</td><td>The model used in the simulation. </td></tr>
    <tr><td class="paramname">p_type</td><td>The type of parallelism desired (see <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a3ffcf267836a8c9427b0b1012d3fb9e6" title="The number of threads needed to be used in the simulation (if parallelism is supported). ">nThreads</a>). </td></tr>
    <tr><td class="paramname">randomSeed</td><td>The seed to be used in the initialization of the pseudorandom numbers generator. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html#l00060">60</a> of file <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html">Calculus.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae98174e438b83acfe4afc3e283890ce8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Calculus::~Calculus </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>
<p>Deletes the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html" title="It implements some methods to simulate the irradiation process evaluating the cellular survival on a ...">Calculus</a> object and the gsl_rng pointer. </p>

<p>Definition at line <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html#l00092">92</a> of file <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html">Calculus.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aff1c83dcc7dd667e86e3b08f17db6efe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Calculus::evaluateG </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>trackMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>totalDose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nFrac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>timeSpacing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fracDeliveryTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precision</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform a Monte Carlo simulation delivering a fixed total dose with a defined time structure to a cell population, evaluating the resulting cell survival in order to get the value of the G factor that defines the temporal effect of the irradiation. </p>
<p>The user has to fix:</p>
<ol type="1">
<li>The precision required for the simulation, that is the statistics to be reached to terminate the simulation. Two possibilities are supported, so the user can:<ul>
<li>Fix the number of iterations, hence the <code>precision</code> has to be an integer value greater (or at least equal) to 1.</li>
<li>Define a constraint on the precision to reach in the simulation in the evaluation of the cell survival (precisely the relative error on the survival), hence the <code>precision</code> has to be a <code>double</code> in (0, 1).</li>
</ul>
</li>
<li>The structure of the irradiation, which is defined by:<ul>
<li>The total dose to be delivered.</li>
<li>The number of fractions of the treatment.</li>
<li>The time spacing between two consecutive fractions.</li>
<li>The time needed to deliver a single fraction. Once set these features, the irradiation process of the cell population is simulated by calling the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#aa500fd3a7915675ca3f53cf16c4374f3" title="Simulates via the Monte Carlo method the irradiation process of a nucleus, which is part of the cellu...">histogram_dose_survival_t()</a> method in a parallel loop. Each thread performs the irradiation of a single cell (with its complete time structure) and at the end of each irradiation the method updates the total mean dose and survival observed, with associated uncertainties, and determines if the precision set by the user is reached or not. All the values of dose and survival obtained, cell by cell, are saved in an output file. Once reached the precision required, the method evaluates the G factor using the LQ <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> and <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/> parameters obtained in the case of acute irradiation (parameters of the function) by means of the relation: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ G=\frac{-\ln(S)-\alpha D}{\beta D^2} \]" src="../../form_2.png"/>
</p>
 where D is the total dose delivered and S the resulting survival. It evaluates also the G factor following the analytical expression (valid only in case of fractionated treatment with neglecting the intra-fraction time structure): <p class="formulaDsp">
<img class="formulaDsp" alt="\[ G=1-\frac{2}{D^2}\sum_{i=0}^{N-1}\sum_{j=i+1}^{N-2}\left(1-\exp[-(a+c)(t_j-t_i)]\right)d^2 \]" src="../../form_3.png"/>
</p>
 where d represents the dose delivered per fraction, N the total number of fractions, <img class="formulaInl" alt="$(t_j-t_i)$" src="../../form_4.png"/> represents the temporal distance between two fractions and (a+c) is the time constant (see Nucleus_tMKM::ac). The calculated values, together with the informations on the time structure are saved in another output file.</li>
</ul>
</li>
</ol>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="../../df/d88/namespaceSurvival.html">Survival</a> uncertainty: the estimation of the survival uncertainty is knowingly biased, but extremely efficient and memory-friendly. Note that this quantity is used only to decide when it is possible to stop the simulation hence it doesn't affect the result (and that the bias decrease with increasing iteration).</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">trackMode</td><td>Defined for completeness. Only "histogram" is supported. </td></tr>
    <tr><td class="paramname">totalDose</td><td>The total dose to be delivered, expressed in Gy. </td></tr>
    <tr><td class="paramname">nFrac</td><td>The total number of fractions constituting the treatment. </td></tr>
    <tr><td class="paramname">timeSpacing</td><td>The time spacing between two consecutive fractions, expressed in hours. </td></tr>
    <tr><td class="paramname">fracDeliveryTime</td><td>The time needed to deliver a single fraction, expressed in hours. </td></tr>
    <tr><td class="paramname">precision</td><td>The precision to be reached in the simulation (could be a fixed number of iterations or a constraint on the survival precision). </td></tr>
    <tr><td class="paramname">alpha</td><td>LQ <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> parameter obtained in acute conditions. </td></tr>
    <tr><td class="paramname">beta</td><td>LQ <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/> parameter obtained in acute conditions.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>The execution of the program will be terminated if the precision is not set correctly.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#aa500fd3a7915675ca3f53cf16c4374f3" title="Simulates via the Monte Carlo method the irradiation process of a nucleus, which is part of the cellu...">histogram_dose_survival_t()</a> and <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a7362c07d69d46fa313fd2ca68b88de90" title="Perform the Monte Carlo simulation relatively to a single value of dose imposed and returns the mean ...">slow_meanDose_meanSurvival()</a> </dd></dl>

<p>Definition at line <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html#l00099">99</a> of file <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html">Calculus.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_aff1c83dcc7dd667e86e3b08f17db6efe_cgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_aff1c83dcc7dd667e86e3b08f17db6efe_cgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_aff1c83dcc7dd667e86e3b08f17db6efe_cgraph" id="d3/ddc/classSurvival_1_1Calculus_aff1c83dcc7dd667e86e3b08f17db6efe_cgraph">
<area shape="rect" id="node2" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a4da8e2d8d4a6b805381836f231952fed" title="Declaration of the pure virtual function clone (for a more detailed description see the derived class..." alt="" coords="208,143,341,185"/><area shape="rect" id="node3" href="../../d3/ddc/classSurvival_1_1Calculus.html#aa500fd3a7915675ca3f53cf16c4374f3" title="Simulates via the Monte Carlo method the irradiation process of a nucleus, which is part of the cellu..." alt="" coords="182,209,367,250"/><area shape="rect" id="node13" href="../../d3/d56/classSurvival_1_1CellLine.html#ab6d213f38deff3bf3f08bd06333712d1" title="Returns the time constant associated to the repair kinetics of the nucleus, expressed in ..." alt="" coords="213,274,337,315"/><area shape="rect" id="node4" href="../../dd/d54/classSurvival_1_1Tracks.html#a4413948ed5fc96621bb0aa8c5f5166d5" title="Returns the size of the vector of tracks. " alt="" coords="439,5,588,32"/><area shape="rect" id="node5" href="../../dd/d54/classSurvival_1_1Tracks.html#a7f2e0bce46e3142b6bb6329af22a622b" title="Evaluates and returns the mean LET of the vector of tracks, expressed in keV/um. " alt="" coords="417,56,610,83"/><area shape="rect" id="node6" href="../../dd/d54/classSurvival_1_1Tracks.html#a98058ff7f4ff4ebc3eb51a1198bf3015" title="Returns the total weight of the group of particles generating the vector of tracks. " alt="" coords="659,74,831,115"/><area shape="rect" id="node7" href="../../dd/d54/classSurvival_1_1Tracks.html#ac1a6efb09c4e1eef98ede817db8edcf2" title="Returns the density of the medium in . " alt="" coords="419,157,607,184"/><area shape="rect" id="node8" href="../../d3/d6c/classSurvival_1_1Nucleus.html#aa32471aeb6af3f71a73413d56467a18c" title="Declaration of the pure virtual function getRadius (for a more detailed description see the derived c..." alt="" coords="447,209,580,250"/><area shape="rect" id="node9" href="../../d3/ddc/classSurvival_1_1Calculus.html#aa3f0e540feb07414181a3ddc9a5dc289" title="Generate an ordered fixed&#45;size sequence of pseudorandom numbers in [begin, begin+duration]. " alt="" coords="444,274,583,315"/><area shape="rect" id="node10" href="../../d3/d4c/classSurvival_1_1Track.html#abd918df6e0738bdf50d908770b809cd8" title="Declaration of the pure virtual function setPosition (for a more detailed description see the derived..." alt="" coords="422,340,605,367"/><area shape="rect" id="node11" href="../../d3/d4c/classSurvival_1_1Track.html#a5dcb85c3c1363c6166a46435308a6bd1" title="Declaration of the pure virtual function setTime (for a more detailed description see the derived cla..." alt="" coords="431,391,596,417"/><area shape="rect" id="node12" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a534c8b9731693f31451a7229a6b7b59f" title="Declaration of the pure virtual function distributeDose (for a more detailed description see the deri..." alt="" coords="447,442,580,483"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa3f0e540feb07414181a3ddc9a5dc289"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; double &gt; Calculus::generateSequence </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nEv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>begin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>duration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate an ordered fixed-size sequence of pseudorandom numbers in [begin, begin+duration]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nEv</td><td>Size of the sequence, that is the number of pseudorandom numbers generated. </td></tr>
    <tr><td class="paramname">begin</td><td>The minimum number extractable. </td></tr>
    <tr><td class="paramname">duration</td><td>The width of the interval.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A STL vector containing an ordered sequence of pseudorandom numbers.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The execution of the program will be terminated if a negative "duration" is chosen. </dd></dl>

<p>Definition at line <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html#l00247">247</a> of file <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html">Calculus.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_aa3f0e540feb07414181a3ddc9a5dc289_icgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_aa3f0e540feb07414181a3ddc9a5dc289_icgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_aa3f0e540feb07414181a3ddc9a5dc289_icgraph" id="d3/ddc/classSurvival_1_1Calculus_aa3f0e540feb07414181a3ddc9a5dc289_icgraph">
<area shape="rect" id="node2" href="../../d3/ddc/classSurvival_1_1Calculus.html#aa500fd3a7915675ca3f53cf16c4374f3" title="Simulates via the Monte Carlo method the irradiation process of a nucleus, which is part of the cellu..." alt="" coords="193,38,378,79"/><area shape="rect" id="node3" href="../../d3/ddc/classSurvival_1_1Calculus.html#aff1c83dcc7dd667e86e3b08f17db6efe" title="Perform a Monte Carlo simulation delivering a fixed total dose with a defined time structure to a cel..." alt="" coords="469,5,597,46"/><area shape="rect" id="node4" href="../../d3/ddc/classSurvival_1_1Calculus.html#a7362c07d69d46fa313fd2ca68b88de90" title="Perform the Monte Carlo simulation relatively to a single value of dose imposed and returns the mean ..." alt="" coords="427,70,640,111"/><area shape="rect" id="node5" href="../../d3/ddc/classSurvival_1_1Calculus.html#a71a43500a5655346c3b9ac0f687c999f" title="Method called to perform a Monte Carlo simulation to reproduce the irradiation process getting the LQ..." alt="" coords="688,70,851,111"/><area shape="rect" id="node6" href="../../df/d0a/main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="899,77,949,104"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7f5dbb4c4c72cba8dacd883b65fc8d61"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string Survival::Calculus::getModel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the model used in the simulation. </p>
<dl class="section return"><dt>Returns</dt><dd>A string indicating the model used in the simulation. </dd></dl>

<p>Definition at line <a class="el" href="../../d3/de2/Calculus_8h_source.html#l00128">128</a> of file <a class="el" href="../../d3/de2/Calculus_8h_source.html">Calculus.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab6fbdc8ae32e5741260528c141a2cdd4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Survival::Calculus::getNThreads </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the number of threads used in the simulation. </p>
<dl class="section return"><dt>Returns</dt><dd>The number of threads used in the simulation.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a3ffcf267836a8c9427b0b1012d3fb9e6" title="The number of threads needed to be used in the simulation (if parallelism is supported). ">nThreads</a> </dd></dl>

<p>Definition at line <a class="el" href="../../d3/de2/Calculus_8h_source.html#l00060">60</a> of file <a class="el" href="../../d3/de2/Calculus_8h_source.html">Calculus.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae5f1ea95674d3f9325cccc91d1469660"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Calculus::histogram_dose_survival_p </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>doseImposed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>dose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>doseUncertainty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>survival</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>survivalUncertainty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html">Nucleus</a> &amp;&#160;</td>
          <td class="paramname"><em>nuc_cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>clean</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cellular population. </p>
<p>First of all the function calculate the fluence of the beam on the base of the dose imposed, by means of the following relation: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \Phi=\rho\frac{D}{K\cdot \langle LET\rangle} \]" src="../../form_5.png"/>
</p>
<p> where D is the dose imposed, K is a constant to accounts for the different units of measure used, <img class="formulaInl" alt="$\rho$" src="../../form_6.png"/> is the density of the target and <img class="formulaInl" alt="$\langle LET\rangle$" src="../../form_7.png"/> is the mean value of LET of the radiation (that coincides with the LET of the particle only in the monoenergetic case). The number of particles interacting with the nucleus is randomly extracted with a poisson distribution whose mean value is determined on the basis of the fluence, opportunely normalized accounting also for the weight of the particle used. Then, in two nested <code>for</code> loops over the number of particles extracted and over the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae9cc5cb2e186827348372eeb058890fe" title="A const reference to a Track object corresponding to the Particle interacting with nucleus...">tracks</a> vector, the dose deposited in the nucleus is evaluated by means of the <a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a534c8b9731693f31451a7229a6b7b59f" title="Declaration of the pure virtual function distributeDose (for a more detailed description see the deri...">Nucleus::distributeDose()</a> method. At the end of the loop, dose and survival (with respective uncertainties) are updated by calling the <a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html#adbd3faee7029e64620f3dec187657dfe" title="Declaration of the pure virtual function getDoseAndSurvival (for a more detailed description see the ...">Nucleus::getDoseAndSurvival()</a> method.</p>
<dl class="section note"><dt>Note</dt><dd>Parallelism: If the parallelism is disabled, the same nucleus could be irradiated and cleaned recursively in order to save memory; but if the parallelism is used, each thread must work on a different nucleus, hence this method provide the possibility to indicate also the nucleus to be irradiated with the <code>nuc_cp</code> parameter. This is the only difference between this method and histogram_dose_survival() which is actually useless. It was not deleted only for a chronological reason, because the parallelism was implemented later, but at present it is not used.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">doseImposed</td><td>The dose imposed to be delivered to the nucleus, expressed in Gy. </td></tr>
    <tr><td class="paramname">dose</td><td>The dose absorbed by the nucleus in the irradiation, expressed in Gy, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">doseUncertainty</td><td>The uncertainty associated to the dose absorbed, expressed in Gy, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">survival</td><td>The cellular survival observed, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">survivalUncertainty</td><td>The uncertainty associated to the cellular survival, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">nuc_cp</td><td>A reference to the nucleus to be irradiated. </td></tr>
    <tr><td class="paramname">clean</td><td>A boolean value indicating if the nucleus has to be cleaned at the end of the evaluation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a294fab8fab79c18b557029728c222150" title="Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cell...">random_dose_survival_p()</a> and <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#aa500fd3a7915675ca3f53cf16c4374f3" title="Simulates via the Monte Carlo method the irradiation process of a nucleus, which is part of the cellu...">histogram_dose_survival_t()</a> </dd></dl>

<p>Definition at line <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html#l00264">264</a> of file <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html">Calculus.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_ae5f1ea95674d3f9325cccc91d1469660_cgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_ae5f1ea95674d3f9325cccc91d1469660_cgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_ae5f1ea95674d3f9325cccc91d1469660_cgraph" id="d3/ddc/classSurvival_1_1Calculus_ae5f1ea95674d3f9325cccc91d1469660_cgraph">
<area shape="rect" id="node2" href="../../dd/d54/classSurvival_1_1Tracks.html#a7f2e0bce46e3142b6bb6329af22a622b" title="Evaluates and returns the mean LET of the vector of tracks, expressed in keV/um. " alt="" coords="243,5,437,32"/><area shape="rect" id="node3" href="../../dd/d54/classSurvival_1_1Tracks.html#a98058ff7f4ff4ebc3eb51a1198bf3015" title="Returns the total weight of the group of particles generating the vector of tracks. " alt="" coords="486,23,658,65"/><area shape="rect" id="node4" href="../../dd/d54/classSurvival_1_1Tracks.html#ac1a6efb09c4e1eef98ede817db8edcf2" title="Returns the density of the medium in . " alt="" coords="246,107,434,133"/><area shape="rect" id="node5" href="../../d3/d6c/classSurvival_1_1Nucleus.html#aa32471aeb6af3f71a73413d56467a18c" title="Declaration of the pure virtual function getRadius (for a more detailed description see the derived c..." alt="" coords="273,158,407,199"/><area shape="rect" id="node6" href="../../dd/d54/classSurvival_1_1Tracks.html#a4413948ed5fc96621bb0aa8c5f5166d5" title="Returns the size of the vector of tracks. " alt="" coords="265,224,415,251"/><area shape="rect" id="node7" href="../../d3/d4c/classSurvival_1_1Track.html#abd918df6e0738bdf50d908770b809cd8" title="Declaration of the pure virtual function setPosition (for a more detailed description see the derived..." alt="" coords="249,275,431,301"/><area shape="rect" id="node8" href="../../d3/d4c/classSurvival_1_1Track.html#a5dcb85c3c1363c6166a46435308a6bd1" title="Declaration of the pure virtual function setTime (for a more detailed description see the derived cla..." alt="" coords="257,325,423,352"/><area shape="rect" id="node9" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a534c8b9731693f31451a7229a6b7b59f" title="Declaration of the pure virtual function distributeDose (for a more detailed description see the deri..." alt="" coords="273,377,407,418"/><area shape="rect" id="node10" href="../../d3/d6c/classSurvival_1_1Nucleus.html#adbd3faee7029e64620f3dec187657dfe" title="Declaration of the pure virtual function getDoseAndSurvival (for a more detailed description see the ..." alt="" coords="269,442,411,483"/><area shape="rect" id="node11" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a805a3fbe99df542d135407aa1c2bae28" title="Declaration of the pure virtual function cleanNucleus (for a more detailed description see the derive..." alt="" coords="273,507,407,549"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_ae5f1ea95674d3f9325cccc91d1469660_icgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_ae5f1ea95674d3f9325cccc91d1469660_icgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_ae5f1ea95674d3f9325cccc91d1469660_icgraph" id="d3/ddc/classSurvival_1_1Calculus_ae5f1ea95674d3f9325cccc91d1469660_icgraph">
<area shape="rect" id="node2" href="../../d3/ddc/classSurvival_1_1Calculus.html#a7362c07d69d46fa313fd2ca68b88de90" title="Perform the Monte Carlo simulation relatively to a single value of dose imposed and returns the mean ..." alt="" coords="243,5,456,46"/><area shape="rect" id="node3" href="../../d3/ddc/classSurvival_1_1Calculus.html#a71a43500a5655346c3b9ac0f687c999f" title="Method called to perform a Monte Carlo simulation to reproduce the irradiation process getting the LQ..." alt="" coords="504,5,667,46"/><area shape="rect" id="node4" href="../../df/d0a/main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="715,12,765,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa500fd3a7915675ca3f53cf16c4374f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Calculus::histogram_dose_survival_t </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html">Nucleus</a> &amp;&#160;</td>
          <td class="paramname"><em>nuc_cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>doseImposed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>fracDeliveryTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulates via the Monte Carlo method the irradiation process of a nucleus, which is part of the cellular population, in a single fraction with a defined duration. </p>
<p>First of all the function calculate the fluence of the beam on the base of the dose imposed, by means of the following relation: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \Phi=\rho\frac{D}{K\cdot \langle LET\rangle} \]" src="../../form_5.png"/>
</p>
<p> where D is the dose imposed, K is a constant to accounts for the different units of measure used, <img class="formulaInl" alt="$\rho$" src="../../form_6.png"/> is the density of the target and <img class="formulaInl" alt="$\langle LET\rangle$" src="../../form_7.png"/> is the mean value of LET of the radiation (that coincides with the LET of the particle only in the monoenergetic case). The number of particles interacting with the nucleus is randomly extracted with a poisson distribution whose mean value is determined on the basis of the fluence, opportunely normalized accounting also for the weight of the particle used. Before irradiating, the time structure of the irradiation has to be defined: starting from an instant indicated as parameter of the function ( <img class="formulaInl" alt="$t_0$" src="../../form_8.png"/>), a sequence of times is randomly extracted with uniform probability in <img class="formulaInl" alt="$[t_0,\;t_0+\Delta t]$" src="../../form_9.png"/> (where <img class="formulaInl" alt="$\Delta t$" src="../../form_10.png"/> indicates the fraction delivery time); each time extracted is associated to a particle as its temporal index. Then, in two nested <code>for</code> loops over the number of particles extracted and over the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae9cc5cb2e186827348372eeb058890fe" title="A const reference to a Track object corresponding to the Particle interacting with nucleus...">tracks</a> vector, the dose deposited in the nucleus is evaluated by means of the <a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a534c8b9731693f31451a7229a6b7b59f" title="Declaration of the pure virtual function distributeDose (for a more detailed description see the deri...">Nucleus::distributeDose()</a> method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nuc_cp</td><td>A reference to the nucleus to be irradiated. </td></tr>
    <tr><td class="paramname">doseImposed</td><td>The dose to be delivered in the irradiation in a single fraction, expressed in Gy. </td></tr>
    <tr><td class="paramname">time</td><td>The starting point of the temporal sequence, expressed in hours. </td></tr>
    <tr><td class="paramname">fracDeliveryTime</td><td>The time needed to deliver a single fraction, expressed in hours.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#aff1c83dcc7dd667e86e3b08f17db6efe" title="Perform a Monte Carlo simulation delivering a fixed total dose with a defined time structure to a cel...">evaluateG()</a> and <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae5f1ea95674d3f9325cccc91d1469660" title="Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cell...">histogram_dose_survival_p()</a> </dd></dl>

<p>Definition at line <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html#l00315">315</a> of file <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html">Calculus.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_aa500fd3a7915675ca3f53cf16c4374f3_cgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_aa500fd3a7915675ca3f53cf16c4374f3_cgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_aa500fd3a7915675ca3f53cf16c4374f3_cgraph" id="d3/ddc/classSurvival_1_1Calculus_aa500fd3a7915675ca3f53cf16c4374f3_cgraph">
<area shape="rect" id="node2" href="../../dd/d54/classSurvival_1_1Tracks.html#a4413948ed5fc96621bb0aa8c5f5166d5" title="Returns the size of the vector of tracks. " alt="" coords="263,5,412,32"/><area shape="rect" id="node3" href="../../dd/d54/classSurvival_1_1Tracks.html#a7f2e0bce46e3142b6bb6329af22a622b" title="Evaluates and returns the mean LET of the vector of tracks, expressed in keV/um. " alt="" coords="241,56,434,83"/><area shape="rect" id="node4" href="../../dd/d54/classSurvival_1_1Tracks.html#a98058ff7f4ff4ebc3eb51a1198bf3015" title="Returns the total weight of the group of particles generating the vector of tracks. " alt="" coords="483,74,655,115"/><area shape="rect" id="node5" href="../../dd/d54/classSurvival_1_1Tracks.html#ac1a6efb09c4e1eef98ede817db8edcf2" title="Returns the density of the medium in . " alt="" coords="243,157,431,184"/><area shape="rect" id="node6" href="../../d3/d6c/classSurvival_1_1Nucleus.html#aa32471aeb6af3f71a73413d56467a18c" title="Declaration of the pure virtual function getRadius (for a more detailed description see the derived c..." alt="" coords="271,209,404,250"/><area shape="rect" id="node7" href="../../d3/ddc/classSurvival_1_1Calculus.html#aa3f0e540feb07414181a3ddc9a5dc289" title="Generate an ordered fixed&#45;size sequence of pseudorandom numbers in [begin, begin+duration]. " alt="" coords="268,274,407,315"/><area shape="rect" id="node8" href="../../d3/d4c/classSurvival_1_1Track.html#abd918df6e0738bdf50d908770b809cd8" title="Declaration of the pure virtual function setPosition (for a more detailed description see the derived..." alt="" coords="246,340,429,367"/><area shape="rect" id="node9" href="../../d3/d4c/classSurvival_1_1Track.html#a5dcb85c3c1363c6166a46435308a6bd1" title="Declaration of the pure virtual function setTime (for a more detailed description see the derived cla..." alt="" coords="255,391,420,417"/><area shape="rect" id="node10" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a534c8b9731693f31451a7229a6b7b59f" title="Declaration of the pure virtual function distributeDose (for a more detailed description see the deri..." alt="" coords="271,442,404,483"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_aa500fd3a7915675ca3f53cf16c4374f3_icgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_aa500fd3a7915675ca3f53cf16c4374f3_icgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_aa500fd3a7915675ca3f53cf16c4374f3_icgraph" id="d3/ddc/classSurvival_1_1Calculus_aa500fd3a7915675ca3f53cf16c4374f3_icgraph">
<area shape="rect" id="node2" href="../../d3/ddc/classSurvival_1_1Calculus.html#aff1c83dcc7dd667e86e3b08f17db6efe" title="Perform a Monte Carlo simulation delivering a fixed total dose with a defined time structure to a cel..." alt="" coords="283,5,411,46"/><area shape="rect" id="node3" href="../../d3/ddc/classSurvival_1_1Calculus.html#a7362c07d69d46fa313fd2ca68b88de90" title="Perform the Monte Carlo simulation relatively to a single value of dose imposed and returns the mean ..." alt="" coords="240,70,453,111"/><area shape="rect" id="node4" href="../../d3/ddc/classSurvival_1_1Calculus.html#a71a43500a5655346c3b9ac0f687c999f" title="Method called to perform a Monte Carlo simulation to reproduce the irradiation process getting the LQ..." alt="" coords="501,70,664,111"/><area shape="rect" id="node5" href="../../df/d0a/main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="712,77,763,104"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a47538c45fd5a9b2cd97bea6d41341171"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Calculus::histogram_dose_survival_with_domains </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>doseImposed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>dose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>doseUncertainty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>survival</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>survivalUncertainty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>doses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>lethals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>dosesUncertainty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>lethalsUncertainty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>clean</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cellular population. This function was thought to control the dose delivery inside the MKM nucleus. It's similar to histogram_dose_survival() but provide also informations on the microscopic dose deposition pattern in each domain of the nucleus. </p>
<p>First of all the function calculate the fluence of the beam on the base of the dose imposed, by means of the following relation: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \Phi=\rho\frac{D}{K\cdot \langle LET\rangle} \]" src="../../form_5.png"/>
</p>
<p> where D is the dose imposed, K is a constant to accounts for the different units of measure used, <img class="formulaInl" alt="$\rho$" src="../../form_6.png"/> is the density of the target and <img class="formulaInl" alt="$\langle LET\rangle$" src="../../form_7.png"/> is the mean value of LET of the radiation (that coincides with the LET of the particle only in the monoenergetic case). The number of particles interacting with the nucleus is randomly extracted with a poisson distribution whose mean value is determined on the basis of the fluence, opportunely normalized accounting also for the weight of the particle used. Then, in two nested <code>for</code> loops over the number of particles extracted and over the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae9cc5cb2e186827348372eeb058890fe" title="A const reference to a Track object corresponding to the Particle interacting with nucleus...">tracks</a> vector, the dose deposited in the nucleus is evaluated by means of the <a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a534c8b9731693f31451a7229a6b7b59f" title="Declaration of the pure virtual function distributeDose (for a more detailed description see the deri...">Nucleus::distributeDose()</a> method. At the end of the loop, dose and survival (with respective uncertainties) are updated by calling the <a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html#adbd3faee7029e64620f3dec187657dfe" title="Declaration of the pure virtual function getDoseAndSurvival (for a more detailed description see the ...">Nucleus::getDoseAndSurvival()</a> method. It returns also the microscopical informations on doses deposited and lethal events observed in each domain by overwriting the correspondent parameters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">doseImposed</td><td>The dose imposed to be delivered to the nucleus, expressed in Gy. </td></tr>
    <tr><td class="paramname">dose</td><td>The dose absorbed by the nucleus in the irradiation, expressed in Gy, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">doseUncertainty</td><td>The uncertainty associated to the dose absorbed, expressed in Gy, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">survival</td><td>The cellular survival observed, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">survivalUncertainty</td><td>The uncertainty associated to the cellular survival, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">doses</td><td>The vector of doses absorbed by each domain, expressed in Gy, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">lethals</td><td>The vector of lethal events observed in each domain, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">dosesUncertainty</td><td>The uncertainties associated to the doses absorbed, expressed in Gy, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">lethalsUncertainty</td><td>The uncertainties associated to the lethal events observed, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">clean</td><td>A boolean value indicating if the nucleus has to be cleaned at the end of the evaluation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae5f1ea95674d3f9325cccc91d1469660" title="Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cell...">histogram_dose_survival_p()</a> </dd></dl>

<p>Definition at line <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html#l00365">365</a> of file <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html">Calculus.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_a47538c45fd5a9b2cd97bea6d41341171_cgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_a47538c45fd5a9b2cd97bea6d41341171_cgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_a47538c45fd5a9b2cd97bea6d41341171_cgraph" id="d3/ddc/classSurvival_1_1Calculus_a47538c45fd5a9b2cd97bea6d41341171_cgraph">
<area shape="rect" id="node2" href="../../dd/d54/classSurvival_1_1Tracks.html#a7f2e0bce46e3142b6bb6329af22a622b" title="Evaluates and returns the mean LET of the vector of tracks, expressed in keV/um. " alt="" coords="230,5,423,32"/><area shape="rect" id="node3" href="../../dd/d54/classSurvival_1_1Tracks.html#a98058ff7f4ff4ebc3eb51a1198bf3015" title="Returns the total weight of the group of particles generating the vector of tracks. " alt="" coords="473,23,645,65"/><area shape="rect" id="node4" href="../../dd/d54/classSurvival_1_1Tracks.html#ac1a6efb09c4e1eef98ede817db8edcf2" title="Returns the density of the medium in . " alt="" coords="233,107,421,133"/><area shape="rect" id="node5" href="../../d3/d6c/classSurvival_1_1Nucleus.html#aa32471aeb6af3f71a73413d56467a18c" title="Declaration of the pure virtual function getRadius (for a more detailed description see the derived c..." alt="" coords="260,158,393,199"/><area shape="rect" id="node6" href="../../dd/d54/classSurvival_1_1Tracks.html#a4413948ed5fc96621bb0aa8c5f5166d5" title="Returns the size of the vector of tracks. " alt="" coords="252,224,401,251"/><area shape="rect" id="node7" href="../../d3/d4c/classSurvival_1_1Track.html#abd918df6e0738bdf50d908770b809cd8" title="Declaration of the pure virtual function setPosition (for a more detailed description see the derived..." alt="" coords="235,275,418,301"/><area shape="rect" id="node8" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a534c8b9731693f31451a7229a6b7b59f" title="Declaration of the pure virtual function distributeDose (for a more detailed description see the deri..." alt="" coords="260,326,393,367"/><area shape="rect" id="node9" href="../../d3/d6c/classSurvival_1_1Nucleus.html#adbd3faee7029e64620f3dec187657dfe" title="Declaration of the pure virtual function getDoseAndSurvival (for a more detailed description see the ..." alt="" coords="256,391,397,433"/><area shape="rect" id="node10" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a8cc959e4e88632a3fcc49ca20b0f45bc" title="Declaration of the virtual function getDosesandLethals (for a more detailed description see the deriv..." alt="" coords="255,457,398,498"/><area shape="rect" id="node11" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a805a3fbe99df542d135407aa1c2bae28" title="Declaration of the pure virtual function cleanNucleus (for a more detailed description see the derive..." alt="" coords="260,522,393,563"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_a47538c45fd5a9b2cd97bea6d41341171_icgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_a47538c45fd5a9b2cd97bea6d41341171_icgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_a47538c45fd5a9b2cd97bea6d41341171_icgraph" id="d3/ddc/classSurvival_1_1Calculus_a47538c45fd5a9b2cd97bea6d41341171_icgraph">
<area shape="rect" id="node2" href="../../d3/ddc/classSurvival_1_1Calculus.html#aac0abf30856195062b94015937838aaf" title="Perform the Monte Carlo simulation relatively to a single value of dose imposed and returns the mean ..." alt="" coords="229,4,443,60"/><area shape="rect" id="node3" href="../../d3/ddc/classSurvival_1_1Calculus.html#a5354e680ba838228dba9624b1e0a6ca7" title="This function was thought to control the dose delivery inside the MKM nucleus. It&#39;s similar to slow_a..." alt="" coords="491,4,653,60"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a294fab8fab79c18b557029728c222150"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Calculus::random_dose_survival_p </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>doseImposed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>dose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>doseUncertainty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>survival</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>survivalUncertainty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html">Nucleus</a> &amp;&#160;</td>
          <td class="paramname"><em>nuc_cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>clean</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cellular population. </p>
<p>First of all the function calculate the fluence of the beam on the base of the dose imposed, by means of the following relation: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \Phi=\rho\frac{D}{K\cdot \langle LET\rangle} \]" src="../../form_5.png"/>
</p>
<p> where D is the dose imposed, K is a constant to accounts for the different units of measure used, <img class="formulaInl" alt="$\rho$" src="../../form_6.png"/> is the density of the target and <img class="formulaInl" alt="$\langle LET\rangle$" src="../../form_7.png"/> is the mean value of LET of the radiation (that coincides with the LET of the particle only in the monoenergetic case). The number of particles interacting with the nucleus is randomly extracted with a poisson distribution whose mean value is determined on the basis of the fluence, opportunely normalized. Then, in a <code>for</code> loops over the total number of particles extracted, a different particle from the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae9cc5cb2e186827348372eeb058890fe" title="A const reference to a Track object corresponding to the Particle interacting with nucleus...">tracks</a> vector is randomly chosen (iteration by iteration) with uniform probability and the dose deposited in the nucleus is evaluated by means of the <a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a534c8b9731693f31451a7229a6b7b59f" title="Declaration of the pure virtual function distributeDose (for a more detailed description see the deri...">Nucleus::distributeDose()</a> method. At the end of the loop, dose and survival (with respective uncertainties) are updated by calling the <a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html#adbd3faee7029e64620f3dec187657dfe" title="Declaration of the pure virtual function getDoseAndSurvival (for a more detailed description see the ...">Nucleus::getDoseAndSurvival()</a> method.</p>
<dl class="section note"><dt>Note</dt><dd>Parallelism: If the parallelism is disabled, the same nucleus could be irradiated and cleaned recursively in order to save memory; but if the parallelism is used, each thread must work on a different nucleus, hence this method provide the possibility to indicate also the nucleus to be irradiated with the <code>nuc_cp</code> parameter. This is the only difference between this method and random_dose_survival() which is actually useless. It was not deleted only for a chronological reason, because the parallelism was implemented later, but at present it is not used.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">doseImposed</td><td>The dose imposed to be delivered to the nucleus, expressed in Gy. </td></tr>
    <tr><td class="paramname">dose</td><td>The dose absorbed by the nucleus in the irradiation, expressed in Gy, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">doseUncertainty</td><td>The uncertainty associated to the dose absorbed, expressed in Gy, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">survival</td><td>The cellular survival observed, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">survivalUncertainty</td><td>The uncertainty associated to the cellular survival, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">nuc_cp</td><td>A reference to the nucleus to be irradiated. </td></tr>
    <tr><td class="paramname">clean</td><td>A boolean value indicating if the nucleus has to be cleaned at the end of the evaluation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd>random_dose_survival(), <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae5f1ea95674d3f9325cccc91d1469660" title="Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cell...">histogram_dose_survival_p()</a> and <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a7362c07d69d46fa313fd2ca68b88de90" title="Perform the Monte Carlo simulation relatively to a single value of dose imposed and returns the mean ...">slow_meanDose_meanSurvival()</a> </dd></dl>

<p>Definition at line <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html#l00419">419</a> of file <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html">Calculus.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_a294fab8fab79c18b557029728c222150_cgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_a294fab8fab79c18b557029728c222150_cgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_a294fab8fab79c18b557029728c222150_cgraph" id="d3/ddc/classSurvival_1_1Calculus_a294fab8fab79c18b557029728c222150_cgraph">
<area shape="rect" id="node2" href="../../dd/d54/classSurvival_1_1Tracks.html#a4413948ed5fc96621bb0aa8c5f5166d5" title="Returns the size of the vector of tracks. " alt="" coords="249,5,399,32"/><area shape="rect" id="node3" href="../../d3/d6c/classSurvival_1_1Nucleus.html#aa32471aeb6af3f71a73413d56467a18c" title="Declaration of the pure virtual function getRadius (for a more detailed description see the derived c..." alt="" coords="257,57,391,98"/><area shape="rect" id="node4" href="../../dd/d54/classSurvival_1_1Tracks.html#ac1a6efb09c4e1eef98ede817db8edcf2" title="Returns the density of the medium in . " alt="" coords="230,123,418,149"/><area shape="rect" id="node5" href="../../d3/d4c/classSurvival_1_1Track.html#abd918df6e0738bdf50d908770b809cd8" title="Declaration of the pure virtual function setPosition (for a more detailed description see the derived..." alt="" coords="233,173,415,200"/><area shape="rect" id="node6" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a534c8b9731693f31451a7229a6b7b59f" title="Declaration of the pure virtual function distributeDose (for a more detailed description see the deri..." alt="" coords="257,225,391,266"/><area shape="rect" id="node7" href="../../d3/d6c/classSurvival_1_1Nucleus.html#adbd3faee7029e64620f3dec187657dfe" title="Declaration of the pure virtual function getDoseAndSurvival (for a more detailed description see the ..." alt="" coords="253,290,395,331"/><area shape="rect" id="node8" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a44f481a9cf5bc5ab59cc198db0f00ed1" title="Declaration of the pure virtual function getInNucleusCount (for a more detailed description see the d..." alt="" coords="257,355,391,397"/><area shape="rect" id="node9" href="../../d3/d6c/classSurvival_1_1Nucleus.html#ad8fb8b4097f18f7f08920a66759afbb1" title="Declaration of the pure virtual function getIntersectionCount (for a more detailed description see th..." alt="" coords="253,421,395,462"/><area shape="rect" id="node10" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a805a3fbe99df542d135407aa1c2bae28" title="Declaration of the pure virtual function cleanNucleus (for a more detailed description see the derive..." alt="" coords="257,486,391,527"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_a294fab8fab79c18b557029728c222150_icgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_a294fab8fab79c18b557029728c222150_icgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_a294fab8fab79c18b557029728c222150_icgraph" id="d3/ddc/classSurvival_1_1Calculus_a294fab8fab79c18b557029728c222150_icgraph">
<area shape="rect" id="node2" href="../../d3/ddc/classSurvival_1_1Calculus.html#a7362c07d69d46fa313fd2ca68b88de90" title="Perform the Monte Carlo simulation relatively to a single value of dose imposed and returns the mean ..." alt="" coords="229,5,443,46"/><area shape="rect" id="node3" href="../../d3/ddc/classSurvival_1_1Calculus.html#a71a43500a5655346c3b9ac0f687c999f" title="Method called to perform a Monte Carlo simulation to reproduce the irradiation process getting the LQ..." alt="" coords="491,5,653,46"/><area shape="rect" id="node4" href="../../df/d0a/main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="701,12,752,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adb67296b683897b7af5ced335b695a23"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Calculus::rapidINFN_alphaIon_betaIon </td>
          <td>(</td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>alphaIon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>betaIon</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This method was developed to improve both the <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> and <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/> estimation with respect to the approach of Scholz. It is currently applicable to the LEM I version only (the possibility of extending the approach to the subsequent versions is under investigation). </p>
<p>This method is based on a quasi-analytic solution of the LEM for the <img class="formulaInl" alt="$\alpha_P$" src="../../form_11.png"/> and <img class="formulaInl" alt="$\beta_P$" src="../../form_12.png"/> parameters.</p>
<dl class="section warning"><dt>Warning</dt><dd>It hasn't been implemented yet. </dd></dl>

<p>Definition at line <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html#l00479">479</a> of file <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html">Calculus.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae5d0c2ac1627f5f09be324e8f22f5e49"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Calculus::rapidMKM_Hawkins_alphaIon_betaIon </td>
          <td>(</td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>alphaIon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>betaIon</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Different implementation of the rapidMKM calculation. </p>
<p>The only difference between this method and <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a25393348b530b7d5ef5146181a930b08" title="This method provide the original analytic implementation of the MKM model, as it is described by Hawk...">rapidMKM_Kase_alphaIon_betaIon()</a> is the way in which it evaluates the <img class="formulaInl" alt="$\gamma_{nucleus}$" src="../../form_13.png"/>, as the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a25393348b530b7d5ef5146181a930b08" title="This method provide the original analytic implementation of the MKM model, as it is described by Hawk...">rapidMKM_Kase_alphaIon_betaIon()</a> uses the approximation: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \gamma_{nucleus}=\frac{LET}{\rho\,\sigma} \]" src="../../form_14.png"/>
</p>
<p> while the present method evaluates it in a more rigorous way, as: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \gamma=\frac{\left\langle z_n^2\right\rangle}{\left\langle z_n\right\rangle} \]" src="../../form_15.png"/>
</p>
<p> where <img class="formulaInl" alt="$z_n$" src="../../form_16.png"/> is the specific energy deposited in the nucleus in each interaction event.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alphaIon</td><td>The LQ <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> parameter expressed in <img class="formulaInl" alt="$Gy^{-1}$" src="../../form_17.png"/>, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">betaIon</td><td>The LQ <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/> parameter expressed in <img class="formulaInl" alt="$Gy^{-2}$" src="../../form_18.png"/>, passed by reference to be overwritten. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html#l00558">558</a> of file <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html">Calculus.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_ae5d0c2ac1627f5f09be324e8f22f5e49_cgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_ae5d0c2ac1627f5f09be324e8f22f5e49_cgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_ae5d0c2ac1627f5f09be324e8f22f5e49_cgraph" id="d3/ddc/classSurvival_1_1Calculus_ae5d0c2ac1627f5f09be324e8f22f5e49_cgraph">
<area shape="rect" id="node2" href="../../d3/d56/classSurvival_1_1CellLine.html#a7979048df877344f8656e9c1830cf9f6" title="Returns the linear quadratic &#160;and &#160;parameters and the transition dose, corresponding to the selected ..." alt="" coords="286,149,410,190"/><area shape="rect" id="node7" href="../../d3/d56/classSurvival_1_1CellLine.html#a8a2652918b7f03f1baea219bb4884f58" title="Returns the radius of the domain expressed in um. " alt="" coords="281,346,415,387"/><area shape="rect" id="node8" href="../../d3/d56/classSurvival_1_1CellLine.html#a850ce403d91953b71f89cbe1aba93517" title="Returns the radius of the nucleus expressed in um. " alt="" coords="279,411,417,453"/><area shape="rect" id="node9" href="../../d3/d56/classSurvival_1_1CellLine.html#a9e34227e45116394b6da71a0f109029e" title="Adds the LQ_noDt parametrization to the cell line (used in the MKM model) for the evaluation of the c..." alt="" coords="277,476,419,532"/><area shape="rect" id="node10" href="../../d3/d56/classSurvival_1_1CellLine.html#ad29a1a2dc4635840d5ffee8139347fa6" title="Sets an X&#45;ray parametrization for the evaluation of the cellular survival. " alt="" coords="279,279,417,321"/><area shape="rect" id="node16" href="../../dd/d54/classSurvival_1_1Tracks.html#a4413948ed5fc96621bb0aa8c5f5166d5" title="Returns the size of the vector of tracks. " alt="" coords="273,556,423,583"/><area shape="rect" id="node17" href="../../d3/d4c/classSurvival_1_1Track.html#a0f268b2048c965a9c1a2604e786b55a7" title="Declaration of the pure virtual function getRadius (for a more detailed description see the derived c..." alt="" coords="513,607,690,633"/><area shape="rect" id="node18" href="../../d3/d4c/classSurvival_1_1Track.html#abd918df6e0738bdf50d908770b809cd8" title="Declaration of the pure virtual function setPosition (for a more detailed description see the derived..." alt="" coords="257,724,439,751"/><area shape="rect" id="node19" href="../../d7/d3d/classSurvival_1_1Nucleus__Integral.html#ad2accdc21874fcd9ce45859d7a2ba4c9" title="Integrates the radial profile of the track in the intersection area with the nucleus to evaluate the ..." alt="" coords="261,658,435,699"/><area shape="rect" id="node25" href="../../d7/d3d/classSurvival_1_1Nucleus__Integral.html#af77998a851d5b3c5383d42aac51b185e" title="Returns (overwriting parameters passed by reference) the dose absorbed by the nucleus and the associa..." alt="" coords="261,775,435,817"/><area shape="rect" id="node27" href="../../d7/d3d/classSurvival_1_1Nucleus__Integral.html#a798586699f6ac83e4a032e93b581514e" title="Resets to zero inNucleusCount and intersectionCount counters and the total dose absorbed (totalNucleu..." alt="" coords="261,841,435,882"/><area shape="rect" id="node3" href="../../d3/d56/classSurvival_1_1CellLine.html#acce6d741c107dc05cca0934a62aca1ac" title="Returns the logarithmic cellular survival corresponding to a particular dose absorbed. Implements the parametrization used in the MKM formulation. " alt="" coords="512,5,691,46"/><area shape="rect" id="node4" href="../../d3/d56/classSurvival_1_1CellLine.html#a2284eb3b95312bec7992d4eff602bc7d" title="Returns the logarithmic cellular survival associated to a sequence of doses absorbed with a specific ..." alt="" coords="530,69,673,125"/><area shape="rect" id="node5" href="../../d3/d56/classSurvival_1_1CellLine.html#abaccc7a0370420ce9bc31e5149008367" title="Returns the logarithmic cellular survival corresponding to a particular dose absorbed. Implements the parametrization used in the LEM I formulation. " alt="" coords="530,149,673,190"/><area shape="rect" id="node6" href="../../d3/d56/classSurvival_1_1CellLine.html#ab5b17b0449469fc2d73a71bf1d1977bf" title="Returns the logarithmic cellular survival corresponding to a particular dose absorbed. Implements the parametrization used in the LEM II formulation. " alt="" coords="526,214,677,255"/><area shape="rect" id="node11" href="../../d3/d56/classSurvival_1_1CellLine.html#a76685a6295497c003e1150d4707ac9ba" title="Returns the logarithmic cellular survival corresponding to a particular dose absorbed. Implements the parametrization used in the LEM II formulation. " alt="" coords="526,410,677,451"/><area shape="rect" id="node12" href="../../d3/d56/classSurvival_1_1CellLine.html#a091a28b39cb58f27987f814553db0a7c" title="Get the value of the damage enhancement factor from the precalculated curve (doseForEta, etaPre) interpolating the nearest neighbors of the dose imposed. " alt="" coords="488,475,715,517"/><area shape="rect" id="node13" href="../../d3/d56/classSurvival_1_1CellLine.html#a670110708749c9ba54bb909271757c21" title="Reads and returns the value of the damage enhancement factor correspondent to the required dose from ..." alt="" coords="509,541,693,582"/><area shape="rect" id="node14" href="../../d3/d56/classSurvival_1_1CellLine.html#aac93d399c3ecfd5af8c8f776600367e1" title="Evaluate the damage enhancement factor by means of an analytic approximated expression. " alt="" coords="499,279,703,321"/><area shape="rect" id="node15" href="../../d3/d56/classSurvival_1_1CellLine.html#a163356583c893e163f7844bf99cd526e" title="Evaluate the damage enhancement factor corresponding to a certain dose absorbed via a Monte Carlo sim..." alt="" coords="523,345,679,386"/><area shape="rect" id="node20" href="../../d3/d4c/classSurvival_1_1Track.html#a7cbd42c4881770c7bb89d8baad8c81a0" title="Declaration of the pure virtual function getPosition (for a more detailed description see the derived..." alt="" coords="510,657,693,684"/><area shape="rect" id="node21" href="../../d3/d4c/classSurvival_1_1Track.html#adf431f091753b442cc903170a0f99b11" title="Declaration of the pure virtual function getRadialIntegral (for a more detailed description see the d..." alt="" coords="515,709,688,750"/><area shape="rect" id="node22" href="../../d7/d3d/classSurvival_1_1Nucleus__Integral.html#adf4ae59e1328acdf875a3e036b1c07b3" title="Performs the integral of the radial profile of the track in the intersection area with the nucleus..." alt="" coords="498,774,705,815"/><area shape="rect" id="node23" href="../../d7/d3d/classSurvival_1_1Nucleus__Integral.html#afcd075b63bb7a091fdbe1c5666d85f7b" title="Evaluate the length of the arc of circumference (expressed in radians) derived from the intersection ..." alt="" coords="775,745,950,786"/><area shape="rect" id="node24" href="../../d3/d4c/classSurvival_1_1Track.html#aacf246b1c633218966efd08bd8733626" title="Declaration of the pure virtual function getLocalDose (for a more detailed description see the derive..." alt="" coords="763,811,962,837"/><area shape="rect" id="node26" href="../../d3/d56/classSurvival_1_1CellLine.html#a86e4e660181036f873b9f347550d7996" title="Returns the natural logarithm of the cellular survival evaluated on the basis of the selected paramet..." alt="" coords="535,839,667,881"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a25393348b530b7d5ef5146181a930b08"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Calculus::rapidMKM_Kase_alphaIon_betaIon </td>
          <td>(</td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>alphaIon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>betaIon</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This method provide the original analytic implementation of the MKM model, as it is described by Hawkins. </p>
<p>This method was developed by Hawkins between 1994 and 2003.</p>
<p>Here, the rigorous derivations of the formulas used is omitted, the reader interested could look at the works of Hawkins (<a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#MKM1">1</a>, <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#MKM2">2</a>).</p>
<p>In the last developments of the MKM model (<a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#MKM2">2</a> <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#MKM3">3</a>) the estimate for <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> is obtained as: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \alpha=\frac{1-\exp(-\alpha_P\,\gamma_{nucleus})}{\gamma_{nucleus}} \]" src="../../form_19.png"/>
</p>
<p> where <img class="formulaInl" alt="$\gamma_{nucleus}$" src="../../form_13.png"/> is the dose-weighted average of the specific energy deposited in the nucleus by a single track, evaluated by means of the approximated formula: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \gamma_{nucleus}=\frac{LET}{\rho\,\sigma} \]" src="../../form_14.png"/>
</p>
<p> while </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \alpha_P=\alpha_X+\beta_X\,\gamma \]" src="../../form_20.png"/>
</p>
<p> indicating with <img class="formulaInl" alt="$\alpha_X$" src="../../form_21.png"/> and <img class="formulaInl" alt="$\beta_X$" src="../../form_22.png"/> the LQ parameters identified for X-ray irradiation and with <img class="formulaInl" alt="$\gamma$" src="../../form_23.png"/> the dose-weighted average of the dose deposited by a single event in the domain, or: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \gamma=\frac{\left\langle z_d^2\right\rangle}{\left\langle z_d\right\rangle} \]" src="../../form_24.png"/>
</p>
<p> where <img class="formulaInl" alt="$z_d$" src="../../form_25.png"/> is the specific energy deposited in the single domain in each interaction event. For <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/> no recipe is available. In most of the applications it is assumed to be constant and equal to <img class="formulaInl" alt="$\beta_X$" src="../../form_22.png"/>, even if this contrasts with most of the experimental data. To accounts also for the mixed fields, the method estimates <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> and <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/> for each tracks of the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae9cc5cb2e186827348372eeb058890fe" title="A const reference to a Track object corresponding to the Particle interacting with nucleus...">tracks</a> vector accounting also for the particle weight (<a class="el" href="../../d3/d2a/classSurvival_1_1Particle.html#a2146bfe7ca531b6dc2780c48fffd793d" title="The weight of this particular particle type in the beam. Useful in the case of &quot;mixed fields&quot;...">Particle::weight</a>). Then <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> and <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/> are evaluating according to the TDRA: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \alpha=\frac{\sum_i\,\alpha_i\,LET_i}{\sum_i\,LET_i} \]" src="../../form_26.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sqrt{\beta}=\frac{\sum_i\,\sqrt{\beta_i}\,LET_i}{\sum_i\,LET_i} \]" src="../../form_27.png"/>
</p>
<p>The function provide also the possibility to plot the results.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alphaIon</td><td>The LQ <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> parameter expressed in <img class="formulaInl" alt="$Gy^{-1}$" src="../../form_17.png"/>, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">betaIon</td><td>The LQ <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/> parameter expressed in <img class="formulaInl" alt="$Gy^{-2}$" src="../../form_18.png"/>, passed by reference to be overwritten.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a71a43500a5655346c3b9ac0f687c999f" title="Method called to perform a Monte Carlo simulation to reproduce the irradiation process getting the LQ...">slow_alphaIon_betaIon()</a> and <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae5d0c2ac1627f5f09be324e8f22f5e49" title="Different implementation of the rapidMKM calculation. ">rapidMKM_Hawkins_alphaIon_betaIon()</a></dd></dl>
<p><a class="anchor" id="MKM1"></a>1. R.B. Hawkins, "A Statistical Theory of Cell Killing by Radiation of Varying Linear Energy Transfer", <em>Radiation</em> <em>Research</em> <b>140</b>, 366-374 (1994).</p>
<p><a class="anchor" id="MKM2"></a>2. R.B. Hawkins, "A Microdosimetric-Kinetic Model for the Effect of Non-Poisson Distribution of Lethal Lesions on the Variation of RBE with LET", <em>Radiation</em> <em>Research</em> <b>160</b>, 61-69 (2003).</p>
<p><a class="anchor" id="MKM3"></a>3. Y. Kase, T. Kanai, N. Matsufuji, Y. Furusawa, T. Elsasser, and M. Scholz, "Biophysical calculation of cell survival probabilities using amorphous track structure models for heavy-ion irradiation", <em>Physics</em> <em>in</em> <em>Medicine</em> <em>and</em> <em>Biology</em> <b>53</b>, 37-59 (2008). </p>

<p>Definition at line <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html#l00663">663</a> of file <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html">Calculus.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_a25393348b530b7d5ef5146181a930b08_cgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_a25393348b530b7d5ef5146181a930b08_cgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_a25393348b530b7d5ef5146181a930b08_cgraph" id="d3/ddc/classSurvival_1_1Calculus_a25393348b530b7d5ef5146181a930b08_cgraph">
<area shape="rect" id="node2" href="../../d3/d56/classSurvival_1_1CellLine.html#a7979048df877344f8656e9c1830cf9f6" title="Returns the linear quadratic &#160;and &#160;parameters and the transition dose, corresponding to the selected ..." alt="" coords="270,149,394,190"/><area shape="rect" id="node7" href="../../d3/d56/classSurvival_1_1CellLine.html#a8a2652918b7f03f1baea219bb4884f58" title="Returns the radius of the domain expressed in um. " alt="" coords="265,345,399,386"/><area shape="rect" id="node8" href="../../d3/d56/classSurvival_1_1CellLine.html#a850ce403d91953b71f89cbe1aba93517" title="Returns the radius of the nucleus expressed in um. " alt="" coords="263,410,401,451"/><area shape="rect" id="node9" href="../../d3/d56/classSurvival_1_1CellLine.html#a9e34227e45116394b6da71a0f109029e" title="Adds the LQ_noDt parametrization to the cell line (used in the MKM model) for the evaluation of the c..." alt="" coords="261,475,403,531"/><area shape="rect" id="node10" href="../../d3/d56/classSurvival_1_1CellLine.html#ad29a1a2dc4635840d5ffee8139347fa6" title="Sets an X&#45;ray parametrization for the evaluation of the cellular survival. " alt="" coords="263,279,401,321"/><area shape="rect" id="node16" href="../../dd/d54/classSurvival_1_1Tracks.html#a4413948ed5fc96621bb0aa8c5f5166d5" title="Returns the size of the vector of tracks. " alt="" coords="257,555,407,581"/><area shape="rect" id="node17" href="../../d3/d4c/classSurvival_1_1Track.html#a0f268b2048c965a9c1a2604e786b55a7" title="Declaration of the pure virtual function getRadius (for a more detailed description see the derived c..." alt="" coords="499,607,677,633"/><area shape="rect" id="node18" href="../../d3/d4c/classSurvival_1_1Track.html#abd918df6e0738bdf50d908770b809cd8" title="Declaration of the pure virtual function setPosition (for a more detailed description see the derived..." alt="" coords="241,723,423,749"/><area shape="rect" id="node19" href="../../d7/d3d/classSurvival_1_1Nucleus__Integral.html#ad2accdc21874fcd9ce45859d7a2ba4c9" title="Integrates the radial profile of the track in the intersection area with the nucleus to evaluate the ..." alt="" coords="245,657,419,698"/><area shape="rect" id="node25" href="../../d7/d3d/classSurvival_1_1Nucleus__Integral.html#af77998a851d5b3c5383d42aac51b185e" title="Returns (overwriting parameters passed by reference) the dose absorbed by the nucleus and the associa..." alt="" coords="245,774,419,815"/><area shape="rect" id="node27" href="../../d7/d3d/classSurvival_1_1Nucleus__Integral.html#a798586699f6ac83e4a032e93b581514e" title="Resets to zero inNucleusCount and intersectionCount counters and the total dose absorbed (totalNucleu..." alt="" coords="245,839,419,881"/><area shape="rect" id="node28" href="../../d3/d4c/classSurvival_1_1Track.html#a32e67ac309ca47d21c28a078bb2fa314" title="Declaration of the pure virtual function getLet (for a more detailed description see the derived clas..." alt="" coords="255,905,409,932"/><area shape="rect" id="node29" href="../../dd/d54/classSurvival_1_1Tracks.html#ac1a6efb09c4e1eef98ede817db8edcf2" title="Returns the density of the medium in . " alt="" coords="238,956,426,983"/><area shape="rect" id="node3" href="../../d3/d56/classSurvival_1_1CellLine.html#acce6d741c107dc05cca0934a62aca1ac" title="Returns the logarithmic cellular survival corresponding to a particular dose absorbed. Implements the parametrization used in the MKM formulation. " alt="" coords="499,5,677,46"/><area shape="rect" id="node4" href="../../d3/d56/classSurvival_1_1CellLine.html#a2284eb3b95312bec7992d4eff602bc7d" title="Returns the logarithmic cellular survival associated to a sequence of doses absorbed with a specific ..." alt="" coords="517,69,659,125"/><area shape="rect" id="node5" href="../../d3/d56/classSurvival_1_1CellLine.html#abaccc7a0370420ce9bc31e5149008367" title="Returns the logarithmic cellular survival corresponding to a particular dose absorbed. Implements the parametrization used in the LEM I formulation. " alt="" coords="517,149,659,190"/><area shape="rect" id="node6" href="../../d3/d56/classSurvival_1_1CellLine.html#ab5b17b0449469fc2d73a71bf1d1977bf" title="Returns the logarithmic cellular survival corresponding to a particular dose absorbed. Implements the parametrization used in the LEM II formulation. " alt="" coords="513,214,663,255"/><area shape="rect" id="node11" href="../../d3/d56/classSurvival_1_1CellLine.html#a76685a6295497c003e1150d4707ac9ba" title="Returns the logarithmic cellular survival corresponding to a particular dose absorbed. Implements the parametrization used in the LEM II formulation. " alt="" coords="513,410,663,451"/><area shape="rect" id="node12" href="../../d3/d56/classSurvival_1_1CellLine.html#a091a28b39cb58f27987f814553db0a7c" title="Get the value of the damage enhancement factor from the precalculated curve (doseForEta, etaPre) interpolating the nearest neighbors of the dose imposed. " alt="" coords="475,475,701,517"/><area shape="rect" id="node13" href="../../d3/d56/classSurvival_1_1CellLine.html#a670110708749c9ba54bb909271757c21" title="Reads and returns the value of the damage enhancement factor correspondent to the required dose from ..." alt="" coords="496,541,680,582"/><area shape="rect" id="node14" href="../../d3/d56/classSurvival_1_1CellLine.html#aac93d399c3ecfd5af8c8f776600367e1" title="Evaluate the damage enhancement factor by means of an analytic approximated expression. " alt="" coords="486,279,690,321"/><area shape="rect" id="node15" href="../../d3/d56/classSurvival_1_1CellLine.html#a163356583c893e163f7844bf99cd526e" title="Evaluate the damage enhancement factor corresponding to a certain dose absorbed via a Monte Carlo sim..." alt="" coords="510,345,666,386"/><area shape="rect" id="node20" href="../../d3/d4c/classSurvival_1_1Track.html#a7cbd42c4881770c7bb89d8baad8c81a0" title="Declaration of the pure virtual function getPosition (for a more detailed description see the derived..." alt="" coords="497,657,679,684"/><area shape="rect" id="node21" href="../../d3/d4c/classSurvival_1_1Track.html#adf431f091753b442cc903170a0f99b11" title="Declaration of the pure virtual function getRadialIntegral (for a more detailed description see the d..." alt="" coords="501,709,675,750"/><area shape="rect" id="node22" href="../../d7/d3d/classSurvival_1_1Nucleus__Integral.html#adf4ae59e1328acdf875a3e036b1c07b3" title="Performs the integral of the radial profile of the track in the intersection area with the nucleus..." alt="" coords="485,774,691,815"/><area shape="rect" id="node23" href="../../d7/d3d/classSurvival_1_1Nucleus__Integral.html#afcd075b63bb7a091fdbe1c5666d85f7b" title="Evaluate the length of the arc of circumference (expressed in radians) derived from the intersection ..." alt="" coords="762,745,937,786"/><area shape="rect" id="node24" href="../../d3/d4c/classSurvival_1_1Track.html#aacf246b1c633218966efd08bd8733626" title="Declaration of the pure virtual function getLocalDose (for a more detailed description see the derive..." alt="" coords="750,811,949,837"/><area shape="rect" id="node26" href="../../d3/d56/classSurvival_1_1CellLine.html#a86e4e660181036f873b9f347550d7996" title="Returns the natural logarithm of the cellular survival evaluated on the basis of the selected paramet..." alt="" coords="522,839,654,881"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_a25393348b530b7d5ef5146181a930b08_icgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_a25393348b530b7d5ef5146181a930b08_icgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_a25393348b530b7d5ef5146181a930b08_icgraph" id="d3/ddc/classSurvival_1_1Calculus_a25393348b530b7d5ef5146181a930b08_icgraph">
<area shape="rect" id="node2" href="../../df/d0a/main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="237,19,288,45"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aacf5c74f0c2335627f49f5c2e66a39d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Calculus::rapidRusso_alphaIon_betaIon </td>
          <td>(</td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>alphaIon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>betaIon</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This method is based on the approach of Scholz (<a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a8f34e60d497fee9f958c348a385bc852" title="This method provide a faster approximate implementation of the LEM model that avoids the Monte Carlo ...">rapidScholz_alphaIon_betaIon()</a>) but provides a more precise estimation of the <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> parameter. </p>
<p>This method was proposed by the INFN in 2011, with the work of Russo (<a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#rapidRusso">1</a>). To improve the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a8f34e60d497fee9f958c348a385bc852" title="This method provide a faster approximate implementation of the LEM model that avoids the Monte Carlo ...">rapidScholz_alphaIon_betaIon()</a> method it is necessary to include the effect of ions that, passing near the nucleus, irradiate it only through their track penumbra.</p>
<p>Here, the rigorous derivations of the formulas used is omitted, the reader interested look at the work of Russo (<a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#rapidRusso">1</a>).</p>
<p>The LQ <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> parameter could be calculated in the monoenergetic case as: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \alpha=\alpha_X\left(1-\langle z\rangle_{dir}\frac{\rho A_{nucl}}{LET}\right)+(1-\langle S\rangle_{dir})\frac{\rho A_{nucl}}{LET} \]" src="../../form_28.png"/>
</p>
<p> where <img class="formulaInl" alt="$\rho$" src="../../form_6.png"/> represents the density of the medium, <img class="formulaInl" alt="$A_{nucl}$" src="../../form_29.png"/> the area of the nucleus, <img class="formulaInl" alt="$\langle z\rangle_{dir}$" src="../../form_30.png"/> and <img class="formulaInl" alt="$\langle S\rangle_{dir}$" src="../../form_31.png"/> are the single-event dose and survival corresponding to the ion traversing the nucleus at its center and <img class="formulaInl" alt="$\alpha_X$" src="../../form_21.png"/> is the linear quadratic <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/>-parameter characteristic for X-rays. The <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/> parameter, as in the case of the approach of Scholz, is evaluated as </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \beta=\left(\frac{\alpha}{\alpha_P}\right)^2\beta_P \]" src="../../form_32.png"/>
</p>
<p> where, in this case, diversely from the approach of Scholz: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \alpha_P=\alpha_X\left(1-\langle z\rangle_{dir}\frac{\rho A_{nucl}}{LET}\right)-\ln(\langle S\rangle_{dir})\frac{\rho A_{nucl}}{LET} \]" src="../../form_33.png"/>
</p>
<p> and </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \beta_P=\frac{s-\alpha_P}{2D_t} \]" src="../../form_34.png"/>
</p>
<p> (see the LEM II parametrization for <em>s</em> and <img class="formulaInl" alt="$D_t$" src="../../form_35.png"/>, <a class="el" href="../../d3/d56/classSurvival_1_1CellLine.html#a76685a6295497c003e1150d4707ac9ba" title="Returns the logarithmic cellular survival corresponding to a particular dose absorbed. Implements the parametrization used in the LEM II formulation. ">CellLine::parametrization_LQ2()</a>). To accounts also for the mixed fields, the method evaluates <img class="formulaInl" alt="$\langle S\rangle_{dir}$" src="../../form_31.png"/> for each tracks of the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae9cc5cb2e186827348372eeb058890fe" title="A const reference to a Track object corresponding to the Particle interacting with nucleus...">tracks</a> vector estimating its <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> accounting also for the particle weight (<a class="el" href="../../d3/d2a/classSurvival_1_1Particle.html#a2146bfe7ca531b6dc2780c48fffd793d" title="The weight of this particular particle type in the beam. Useful in the case of &quot;mixed fields&quot;...">Particle::weight</a>). Then <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> and <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/> are evaluating according to the theory of dual radiation action (<a class="el" href="../../d9/d79/classSurvival_1_1Nucleus__MKM.html#TDRA">2</a>): </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \alpha=\frac{\sum_i\,\alpha_i\,LET_i}{\sum_i\,LET_i} \]" src="../../form_26.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sqrt{\beta}=\frac{\sum_i\,\sqrt{\beta_i}\,LET_i}{\sum_i\,LET_i} \]" src="../../form_27.png"/>
</p>
<p> The function provide also the possibility to plot the results.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alphaIon</td><td>The LQ <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> parameter expressed in <img class="formulaInl" alt="$Gy^{-1}$" src="../../form_17.png"/>, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">betaIon</td><td>The LQ <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/> parameter expressed in <img class="formulaInl" alt="$Gy^{-2}$" src="../../form_18.png"/>, passed by reference to be overwritten.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a8f34e60d497fee9f958c348a385bc852" title="This method provide a faster approximate implementation of the LEM model that avoids the Monte Carlo ...">rapidScholz_alphaIon_betaIon()</a> and <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#adb67296b683897b7af5ced335b695a23" title="This method was developed to improve both the  and  estimation with respect to the approach of Scholz...">rapidINFN_alphaIon_betaIon()</a></dd></dl>
<p><a class="anchor" id="rapidRusso"></a>1. G. Russo, "Develpment of a radiobiological database for carbon ion Treatment Planning Systems - Modelling and simulating the irradiation process", <em>PhD</em> <em>Thesis</em>, Università degli studi di Torino (2011).</p>
<p><a class="anchor" id="TDRA"></a>2. M. Zaider and H.H. Rossi, "The synergistic effets of different radiations", <em>Radiation</em> <em>Research</em> <b>160</b>, 61-69 (2003). </p>

<p>Definition at line <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html#l00741">741</a> of file <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html">Calculus.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_aacf5c74f0c2335627f49f5c2e66a39d0_cgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_aacf5c74f0c2335627f49f5c2e66a39d0_cgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_aacf5c74f0c2335627f49f5c2e66a39d0_cgraph" id="d3/ddc/classSurvival_1_1Calculus_aacf5c74f0c2335627f49f5c2e66a39d0_cgraph">
<area shape="rect" id="node2" href="../../d3/d56/classSurvival_1_1CellLine.html#a7979048df877344f8656e9c1830cf9f6" title="Returns the linear quadratic &#160;and &#160;parameters and the transition dose, corresponding to the selected ..." alt="" coords="238,113,362,154"/><area shape="rect" id="node7" href="../../dd/d54/classSurvival_1_1Tracks.html#a4413948ed5fc96621bb0aa8c5f5166d5" title="Returns the size of the vector of tracks. " alt="" coords="225,179,375,205"/><area shape="rect" id="node8" href="../../d3/d4c/classSurvival_1_1Track.html#abd918df6e0738bdf50d908770b809cd8" title="Declaration of the pure virtual function setPosition (for a more detailed description see the derived..." alt="" coords="209,229,391,256"/><area shape="rect" id="node9" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a805a3fbe99df542d135407aa1c2bae28" title="Declaration of the pure virtual function cleanNucleus (for a more detailed description see the derive..." alt="" coords="233,281,367,322"/><area shape="rect" id="node10" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a534c8b9731693f31451a7229a6b7b59f" title="Declaration of the pure virtual function distributeDose (for a more detailed description see the deri..." alt="" coords="233,346,367,387"/><area shape="rect" id="node11" href="../../d3/d6c/classSurvival_1_1Nucleus.html#adbd3faee7029e64620f3dec187657dfe" title="Declaration of the pure virtual function getDoseAndSurvival (for a more detailed description see the ..." alt="" coords="229,411,371,453"/><area shape="rect" id="node12" href="../../d3/d6c/classSurvival_1_1Nucleus.html#aa32471aeb6af3f71a73413d56467a18c" title="Declaration of the pure virtual function getRadius (for a more detailed description see the derived c..." alt="" coords="233,477,367,518"/><area shape="rect" id="node13" href="../../dd/d54/classSurvival_1_1Tracks.html#ac1a6efb09c4e1eef98ede817db8edcf2" title="Returns the density of the medium in . " alt="" coords="206,543,394,569"/><area shape="rect" id="node3" href="../../d3/d56/classSurvival_1_1CellLine.html#acce6d741c107dc05cca0934a62aca1ac" title="Returns the logarithmic cellular survival corresponding to a particular dose absorbed. Implements the parametrization used in the MKM formulation. " alt="" coords="443,5,621,46"/><area shape="rect" id="node4" href="../../d3/d56/classSurvival_1_1CellLine.html#a2284eb3b95312bec7992d4eff602bc7d" title="Returns the logarithmic cellular survival associated to a sequence of doses absorbed with a specific ..." alt="" coords="461,69,603,125"/><area shape="rect" id="node5" href="../../d3/d56/classSurvival_1_1CellLine.html#abaccc7a0370420ce9bc31e5149008367" title="Returns the logarithmic cellular survival corresponding to a particular dose absorbed. Implements the parametrization used in the LEM I formulation. " alt="" coords="461,149,603,190"/><area shape="rect" id="node6" href="../../d3/d56/classSurvival_1_1CellLine.html#ab5b17b0449469fc2d73a71bf1d1977bf" title="Returns the logarithmic cellular survival corresponding to a particular dose absorbed. Implements the parametrization used in the LEM II formulation. " alt="" coords="457,214,607,255"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_aacf5c74f0c2335627f49f5c2e66a39d0_icgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_aacf5c74f0c2335627f49f5c2e66a39d0_icgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_aacf5c74f0c2335627f49f5c2e66a39d0_icgraph" id="d3/ddc/classSurvival_1_1Calculus_aacf5c74f0c2335627f49f5c2e66a39d0_icgraph">
<area shape="rect" id="node2" href="../../df/d0a/main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="205,19,256,45"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8f34e60d497fee9f958c348a385bc852"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Calculus::rapidScholz_alphaIon_betaIon </td>
          <td>(</td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>alphaIon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>betaIon</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This method provide a faster approximate implementation of the LEM model that avoids the Monte Carlo simulation. </p>
<p>This method was proposed by Krämer and Scholz in 2006 (<a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#rapidLEM">1</a>) and it is applicable only to the case of monoenergetic irradiation, but the estimation is extended to the mixed-field case exploiting the Theory of Dual Radiation Action (TDRA) by Zaider and Rossi (<a class="el" href="../../d9/d79/classSurvival_1_1Nucleus__MKM.html#TDRA">2</a>). The method assumes that only direct impacts of ions on the cell nucleus are relevant for the evaluation of the <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> parameter that could be calculated (in the monoenergetic case) as: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \alpha=\frac{\rho A_{nucl}}{LET}(1-\langle S\rangle_{dir}) \]" src="../../form_36.png"/>
</p>
<p> where <img class="formulaInl" alt="$\rho$" src="../../form_6.png"/> represents the density of the medium, <img class="formulaInl" alt="$A_{nucl}$" src="../../form_29.png"/> the area of the nucleus and <img class="formulaInl" alt="$\langle S\rangle_{dir}$" src="../../form_31.png"/> is the single-event survival corresponding to the ion traversing the nucleus at its center, disregarding the small dependence over the ion impact parameter. The <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/> parameter is estimated as: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \beta=\left(\frac{\alpha}{\alpha_P}\right)^2\beta_P \]" src="../../form_32.png"/>
</p>
<p> where </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \alpha_P=-\ln(\langle S\rangle_{dir})\frac{\rho A_{nucl}}{LET} \]" src="../../form_37.png"/>
</p>
<p> and </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \beta_P=\frac{s-\alpha_P}{2D_t} \]" src="../../form_34.png"/>
</p>
<p> (see the LEM II parametrization for <em>s</em> and <img class="formulaInl" alt="$D_t$" src="../../form_35.png"/>, <a class="el" href="../../d3/d56/classSurvival_1_1CellLine.html#a76685a6295497c003e1150d4707ac9ba" title="Returns the logarithmic cellular survival corresponding to a particular dose absorbed. Implements the parametrization used in the LEM II formulation. ">CellLine::parametrization_LQ2()</a>). To accounts also for the mixed fields, the method evaluates <img class="formulaInl" alt="$\langle S\rangle_{dir}$" src="../../form_31.png"/> for each tracks of the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae9cc5cb2e186827348372eeb058890fe" title="A const reference to a Track object corresponding to the Particle interacting with nucleus...">tracks</a> vector estimating its <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> accounting also for the particle weight (<a class="el" href="../../d3/d2a/classSurvival_1_1Particle.html#a2146bfe7ca531b6dc2780c48fffd793d" title="The weight of this particular particle type in the beam. Useful in the case of &quot;mixed fields&quot;...">Particle::weight</a>). Then <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> and <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/> are evaluating according to the TDRA: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \alpha=\frac{\sum_i\,\alpha_i\,LET_i}{\sum_i\,LET_i} \]" src="../../form_26.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sqrt{\beta}=\frac{\sum_i\,\sqrt{\beta_i}\,LET_i}{\sum_i\,LET_i} \]" src="../../form_27.png"/>
</p>
<p> The function provide also the possibility to plot the results.</p>
<dl class="section note"><dt>Note</dt><dd>For a rigorous derivation of the formulas used see the published reference.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alphaIon</td><td>The LQ <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> parameter expressed in <img class="formulaInl" alt="$Gy^{-1}$" src="../../form_17.png"/>, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">betaIon</td><td>The LQ <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/> parameter expressed in <img class="formulaInl" alt="$Gy^{-2}$" src="../../form_18.png"/>, passed by reference to be overwritten.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#aacf5c74f0c2335627f49f5c2e66a39d0" title="This method is based on the approach of Scholz (rapidScholz_alphaIon_betaIon()) but provides a more p...">rapidRusso_alphaIon_betaIon()</a> and <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#adb67296b683897b7af5ced335b695a23" title="This method was developed to improve both the  and  estimation with respect to the approach of Scholz...">rapidINFN_alphaIon_betaIon()</a></dd></dl>
<p><a class="anchor" id="rapidLEM"></a>1. M. Krämer and M. Scholz, "Rapid calculation of biological effects in ion radiotherapy", <em>Physics</em> <em>in</em> <em>medicine</em> <em>and</em> <em>biology</em> <b>51</b>, 1959-1970 (2006).</p>
<p><a class="anchor" id="TDRA"></a>2. M. Zaider and H.H. Rossi, "The synergistic effets of different radiations", <em>Radiation</em> <em>Research</em> <b>160</b>, 61-69 (2003). </p>

<p>Definition at line <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html#l00808">808</a> of file <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html">Calculus.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_a8f34e60d497fee9f958c348a385bc852_cgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_a8f34e60d497fee9f958c348a385bc852_cgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_a8f34e60d497fee9f958c348a385bc852_cgraph" id="d3/ddc/classSurvival_1_1Calculus_a8f34e60d497fee9f958c348a385bc852_cgraph">
<area shape="rect" id="node2" href="../../d3/d56/classSurvival_1_1CellLine.html#a7979048df877344f8656e9c1830cf9f6" title="Returns the linear quadratic &#160;and &#160;parameters and the transition dose, corresponding to the selected ..." alt="" coords="241,113,365,154"/><area shape="rect" id="node7" href="../../dd/d54/classSurvival_1_1Tracks.html#a4413948ed5fc96621bb0aa8c5f5166d5" title="Returns the size of the vector of tracks. " alt="" coords="228,179,377,205"/><area shape="rect" id="node8" href="../../d3/d4c/classSurvival_1_1Track.html#abd918df6e0738bdf50d908770b809cd8" title="Declaration of the pure virtual function setPosition (for a more detailed description see the derived..." alt="" coords="211,229,394,256"/><area shape="rect" id="node9" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a534c8b9731693f31451a7229a6b7b59f" title="Declaration of the pure virtual function distributeDose (for a more detailed description see the deri..." alt="" coords="236,281,369,322"/><area shape="rect" id="node10" href="../../d3/d6c/classSurvival_1_1Nucleus.html#adbd3faee7029e64620f3dec187657dfe" title="Declaration of the pure virtual function getDoseAndSurvival (for a more detailed description see the ..." alt="" coords="232,346,373,387"/><area shape="rect" id="node11" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a805a3fbe99df542d135407aa1c2bae28" title="Declaration of the pure virtual function cleanNucleus (for a more detailed description see the derive..." alt="" coords="236,411,369,453"/><area shape="rect" id="node12" href="../../d3/d4c/classSurvival_1_1Track.html#a32e67ac309ca47d21c28a078bb2fa314" title="Declaration of the pure virtual function getLet (for a more detailed description see the derived clas..." alt="" coords="225,477,380,504"/><area shape="rect" id="node13" href="../../dd/d54/classSurvival_1_1Tracks.html#ac1a6efb09c4e1eef98ede817db8edcf2" title="Returns the density of the medium in . " alt="" coords="209,528,397,555"/><area shape="rect" id="node14" href="../../d3/d6c/classSurvival_1_1Nucleus.html#aa32471aeb6af3f71a73413d56467a18c" title="Declaration of the pure virtual function getRadius (for a more detailed description see the derived c..." alt="" coords="236,579,369,621"/><area shape="rect" id="node15" href="../../d3/d4c/classSurvival_1_1Track.html#a83a478370a74dafe3558d48534a6e502" title="Declaration of the pure virtual function getWeight (for a more detailed description see the derived c..." alt="" coords="214,645,391,672"/><area shape="rect" id="node3" href="../../d3/d56/classSurvival_1_1CellLine.html#acce6d741c107dc05cca0934a62aca1ac" title="Returns the logarithmic cellular survival corresponding to a particular dose absorbed. Implements the parametrization used in the MKM formulation. " alt="" coords="445,5,624,46"/><area shape="rect" id="node4" href="../../d3/d56/classSurvival_1_1CellLine.html#a2284eb3b95312bec7992d4eff602bc7d" title="Returns the logarithmic cellular survival associated to a sequence of doses absorbed with a specific ..." alt="" coords="463,69,606,125"/><area shape="rect" id="node5" href="../../d3/d56/classSurvival_1_1CellLine.html#abaccc7a0370420ce9bc31e5149008367" title="Returns the logarithmic cellular survival corresponding to a particular dose absorbed. Implements the parametrization used in the LEM I formulation. " alt="" coords="463,149,606,190"/><area shape="rect" id="node6" href="../../d3/d56/classSurvival_1_1CellLine.html#ab5b17b0449469fc2d73a71bf1d1977bf" title="Returns the logarithmic cellular survival corresponding to a particular dose absorbed. Implements the parametrization used in the LEM II formulation. " alt="" coords="459,214,610,255"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_a8f34e60d497fee9f958c348a385bc852_icgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_a8f34e60d497fee9f958c348a385bc852_icgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_a8f34e60d497fee9f958c348a385bc852_icgraph" id="d3/ddc/classSurvival_1_1Calculus_a8f34e60d497fee9f958c348a385bc852_icgraph">
<area shape="rect" id="node2" href="../../df/d0a/main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="208,19,259,45"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a60290825861f0f74de61224114b15f96"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Survival::Calculus::setNThreads </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nTh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the number of threads. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nTh</td><td>The number of threads to be set.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a3ffcf267836a8c9427b0b1012d3fb9e6" title="The number of threads needed to be used in the simulation (if parallelism is supported). ">nThreads</a> </dd></dl>

<p>Definition at line <a class="el" href="../../d3/de2/Calculus_8h_source.html#l00418">418</a> of file <a class="el" href="../../d3/de2/Calculus_8h_source.html">Calculus.h</a>.</p>

</div>
</div>
<a class="anchor" id="a532ecb9940306c12f8ca08684057f34e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Survival::Calculus::setSavePrefix </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>save_prefix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the prefix of the output file name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">save_prefix</td><td>The prefix of the output file name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae41fc7fc62ad55b23e6c956243af265a" title="The prefix of the output file. ">savePrefix</a> </dd></dl>

<p>Definition at line <a class="el" href="../../d3/de2/Calculus_8h_source.html#l00426">426</a> of file <a class="el" href="../../d3/de2/Calculus_8h_source.html">Calculus.h</a>.</p>

</div>
</div>
<a class="anchor" id="a71a43500a5655346c3b9ac0f687c999f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Calculus::slow_alphaIon_betaIon </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>trackMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>dosesImposed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>precision</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>alphaIon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>alphaIonUncertainty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>betaIon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>betaIonUncertainty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nFraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>timeSpacing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>fracDeliveryTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>saveAlphaBeta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>saveMeans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>saveCell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>title_means</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Method called to perform a Monte Carlo simulation to reproduce the irradiation process getting the LQ parameters <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> and <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/>. </p>
<p>The idea is to simulate the irradiation process of an entire cell population and to repeat the simulation for different values of dose imposed in order to obtain a complete survival curve. For each value of dose imposed the mean value of dose absorbed and cellular survival observed in the population are obtained by calling the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a7362c07d69d46fa313fd2ca68b88de90" title="Perform the Monte Carlo simulation relatively to a single value of dose imposed and returns the mean ...">slow_meanDose_meanSurvival()</a> method. Then the survival curve is fitted by means of the <a class="el" href="../../df/d88/namespaceSurvival.html#adcc7f2c138e44c5286663a9c38dd14e1">fit_LQ()</a> method in order to get the LQ parameters. Finally the function returns these parameters with the associated uncertainties by overwriting the correspondent variables passed by reference.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">trackMode</td><td>A <code>string</code> defining the modality to pass the vector of particles in the mixed fields case. The possibilities are "histogram" or "random".</td></tr>
    <tr><td class="paramname">parameters</td><td>The vector containing the model parameters to be used in the simulation (<a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#pars">1</a>). </td></tr>
    <tr><td class="paramname">dosesImposed</td><td>A vector containing the values of nominal dose to be simulated, expressed in Gy. </td></tr>
    <tr><td class="paramname">precision</td><td>Fix the ending condition of the Monte Carlo simulation. </td></tr>
    <tr><td class="paramname">alphaIon</td><td>The LQ <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> parameter expressed in <img class="formulaInl" alt="$Gy^{-1}$" src="../../form_17.png"/>, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">alphaIonUncertainty</td><td>The uncertainty associated to the <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> parameter (in <img class="formulaInl" alt="$Gy^{-1}$" src="../../form_17.png"/>), passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">betaIon</td><td>The LQ <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/> parameter expressed in <img class="formulaInl" alt="$Gy^{-2}$" src="../../form_18.png"/>, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">betaIonUncertainty</td><td>The uncertainty associated to the <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/> parameter (in <img class="formulaInl" alt="$Gy^{-2}$" src="../../form_18.png"/>), passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">nFraction</td><td>The total number of fraction, in case of fractionated treatment. </td></tr>
    <tr><td class="paramname">timeSpacing</td><td>The time spacing between fractions, expressed in hours. </td></tr>
    <tr><td class="paramname">fracDeliveryTime</td><td>The delivery time of each fraction, expressed in hours. </td></tr>
    <tr><td class="paramname">saveAlphaBeta</td><td>A boolean parameter indicating if the extrapolated <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> and <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/> parameters are to be saved. </td></tr>
    <tr><td class="paramname">saveMeans</td><td>A boolean parameter indicating if the informations on mean dose and survival observed are to be saved. </td></tr>
    <tr><td class="paramname">saveCell</td><td>A boolean parameter indicating if the dose-survival data of each cell irradiated are to be saved. </td></tr>
    <tr><td class="paramname">title_means</td><td>The title of the file where the method will save the informations on mean dose and survival resultin from the simulation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>The execution of the program will be terminated if the minimum dose imposed is greater than the maximum one or if an inexistent track mode is selected.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a5354e680ba838228dba9624b1e0a6ca7" title="This function was thought to control the dose delivery inside the MKM nucleus. It&#39;s similar to slow_a...">slow_alphaIon_betaIon_with_Domains()</a> and histogram_dose_survival()</dd></dl>
<p><a class="anchor" id="pars"></a>1. These parameters are stored in the <a class="el" href="../../d3/d56/classSurvival_1_1CellLine.html" title="Represents the cell line to which the nucleus belongs and hosts the radiobiological and structural ch...">CellLine</a> object but the way to get them is a little bit tricky, hence this is an easier and not aestethically perfect way to get these informations. This has to be fixed in the next versions of the program. </p>

<p>Definition at line <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html#l00928">928</a> of file <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html">Calculus.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_a71a43500a5655346c3b9ac0f687c999f_cgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_a71a43500a5655346c3b9ac0f687c999f_cgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_a71a43500a5655346c3b9ac0f687c999f_cgraph" id="d3/ddc/classSurvival_1_1Calculus_a71a43500a5655346c3b9ac0f687c999f_cgraph">
<area shape="rect" id="node2" href="../../dd/d54/classSurvival_1_1Tracks.html#a84d7f3a9f76a3d9129f5bee82b3d3bb3" title="Check if the vector is monoenergetic. " alt="" coords="217,380,437,407"/><area shape="rect" id="node3" href="../../d3/ddc/classSurvival_1_1Calculus.html#a7362c07d69d46fa313fd2ca68b88de90" title="Perform the Monte Carlo simulation relatively to a single value of dose imposed and returns the mean ..." alt="" coords="220,431,433,473"/><area shape="rect" id="node17" href="../../dd/d54/classSurvival_1_1Tracks.html#a7f2e0bce46e3142b6bb6329af22a622b" title="Evaluates and returns the mean LET of the vector of tracks, expressed in keV/um. " alt="" coords="723,771,917,797"/><area shape="rect" id="node22" href="../../dd/d54/classSurvival_1_1Tracks.html#aa793a850868fc776660021d87951135a" title="Evaluates and returns the mean energy of the vector of tracks, expressed in MeV. " alt="" coords="493,857,667,898"/><area shape="rect" id="node23" href="../../dd/d54/classSurvival_1_1Tracks.html#a5505534fea3e2888572ba2ccbc210631" title="Evaluate and returns standard deviation of the mean energy of the vector of tracks, expressed in MeV. " alt="" coords="237,878,417,919"/><area shape="rect" id="node24" href="../../dd/d54/classSurvival_1_1Tracks.html#a17b2a67f5baa6fd1a0dbd748f8f8e6f8" title="Evaluate and returns standard deviation of the mean LET of the vector of tracks, expressed in keV/um..." alt="" coords="490,777,670,818"/><area shape="rect" id="node25" href="../../dd/d54/classSurvival_1_1Tracks.html#a3efad3e36d725f21dda77966faed25a8" title="Evaluates and returns the dose averaged LET of the vector of tracks, expressed in keV/um..." alt="" coords="493,989,667,1030"/><area shape="rect" id="node26" href="../../dd/d54/classSurvival_1_1Tracks.html#aa22cdb3170cdb6435a63550962db2664" title="Evaluates and returns the standard deviation of the dose averaged LET of the vector of tracks..." alt="" coords="237,943,417,985"/><area shape="rect" id="node27" href="../../d3/d56/classSurvival_1_1CellLine.html#aaa04a8320c15797661a6f9e10205f303" title="Returns a string identifying the name of the cell line. " alt="" coords="265,1061,389,1102"/><area shape="rect" id="node28" href="../../dd/d54/classSurvival_1_1Tracks.html#aea8c72ae70c0e97dde257e8de3b1b1c9" title="Returns a string identifying the file containing the spectrum of particles to be converted in tracks..." alt="" coords="217,1127,437,1153"/><area shape="rect" id="node29" href="../../df/d88/namespaceSurvival.html#adcc7f2c138e44c5286663a9c38dd14e1" title="Survival::fit_LQ" alt="" coords="271,1177,383,1204"/><area shape="rect" id="node4" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a31ceca4d57048fde5969a2803be25960" title="Declaration of the pure virtual function getCellType (for a more detailed description see the derived..." alt="" coords="513,235,647,277"/><area shape="rect" id="node5" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a4da8e2d8d4a6b805381836f231952fed" title="Declaration of the pure virtual function clone (for a more detailed description see the derived class..." alt="" coords="513,301,647,342"/><area shape="rect" id="node6" href="../../d3/ddc/classSurvival_1_1Calculus.html#a294fab8fab79c18b557029728c222150" title="Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cell..." alt="" coords="493,366,667,407"/><area shape="rect" id="node16" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae5f1ea95674d3f9325cccc91d1469660" title="Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cell..." alt="" coords="486,431,674,473"/><area shape="rect" id="node20" href="../../d3/ddc/classSurvival_1_1Calculus.html#aa500fd3a7915675ca3f53cf16c4374f3" title="Simulates via the Monte Carlo method the irradiation process of a nucleus, which is part of the cellu..." alt="" coords="487,521,673,562"/><area shape="rect" id="node7" href="../../dd/d54/classSurvival_1_1Tracks.html#a4413948ed5fc96621bb0aa8c5f5166d5" title="Returns the size of the vector of tracks. " alt="" coords="745,435,895,461"/><area shape="rect" id="node8" href="../../d3/d6c/classSurvival_1_1Nucleus.html#aa32471aeb6af3f71a73413d56467a18c" title="Declaration of the pure virtual function getRadius (for a more detailed description see the derived c..." alt="" coords="753,486,887,527"/><area shape="rect" id="node9" href="../../dd/d54/classSurvival_1_1Tracks.html#ac1a6efb09c4e1eef98ede817db8edcf2" title="Returns the density of the medium in . " alt="" coords="726,552,914,579"/><area shape="rect" id="node10" href="../../d3/d4c/classSurvival_1_1Track.html#abd918df6e0738bdf50d908770b809cd8" title="Declaration of the pure virtual function setPosition (for a more detailed description see the derived..." alt="" coords="729,267,911,293"/><area shape="rect" id="node11" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a534c8b9731693f31451a7229a6b7b59f" title="Declaration of the pure virtual function distributeDose (for a more detailed description see the deri..." alt="" coords="753,369,887,410"/><area shape="rect" id="node12" href="../../d3/d6c/classSurvival_1_1Nucleus.html#adbd3faee7029e64620f3dec187657dfe" title="Declaration of the pure virtual function getDoseAndSurvival (for a more detailed description see the ..." alt="" coords="749,201,891,242"/><area shape="rect" id="node13" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a44f481a9cf5bc5ab59cc198db0f00ed1" title="Declaration of the pure virtual function getInNucleusCount (for a more detailed description see the d..." alt="" coords="753,70,887,111"/><area shape="rect" id="node14" href="../../d3/d6c/classSurvival_1_1Nucleus.html#ad8fb8b4097f18f7f08920a66759afbb1" title="Declaration of the pure virtual function getIntersectionCount (for a more detailed description see th..." alt="" coords="749,5,891,46"/><area shape="rect" id="node15" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a805a3fbe99df542d135407aa1c2bae28" title="Declaration of the pure virtual function cleanNucleus (for a more detailed description see the derive..." alt="" coords="753,135,887,177"/><area shape="rect" id="node18" href="../../dd/d54/classSurvival_1_1Tracks.html#a98058ff7f4ff4ebc3eb51a1198bf3015" title="Returns the total weight of the group of particles generating the vector of tracks. " alt="" coords="966,789,1138,830"/><area shape="rect" id="node19" href="../../d3/d4c/classSurvival_1_1Track.html#a5dcb85c3c1363c6166a46435308a6bd1" title="Declaration of the pure virtual function setTime (for a more detailed description see the derived cla..." alt="" coords="737,603,903,629"/><area shape="rect" id="node21" href="../../d3/ddc/classSurvival_1_1Calculus.html#aa3f0e540feb07414181a3ddc9a5dc289" title="Generate an ordered fixed&#45;size sequence of pseudorandom numbers in [begin, begin+duration]. " alt="" coords="751,705,889,746"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_a71a43500a5655346c3b9ac0f687c999f_icgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_a71a43500a5655346c3b9ac0f687c999f_icgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_a71a43500a5655346c3b9ac0f687c999f_icgraph" id="d3/ddc/classSurvival_1_1Calculus_a71a43500a5655346c3b9ac0f687c999f_icgraph">
<area shape="rect" id="node2" href="../../df/d0a/main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="216,12,267,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5354e680ba838228dba9624b1e0a6ca7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Calculus::slow_alphaIon_betaIon_with_Domains </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>trackMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>minDose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>maxDose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>numberOfDoses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>precision</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>alphaIon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>alphaIonUncertainty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>betaIon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>betaIonUncertainty</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function was thought to control the dose delivery inside the MKM nucleus. It's similar to <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a71a43500a5655346c3b9ac0f687c999f" title="Method called to perform a Monte Carlo simulation to reproduce the irradiation process getting the LQ...">slow_alphaIon_betaIon()</a> but provide also informations on the microscopic dose deposition pattern in each domain of the nucleus. </p>
<p>The idea is to simulate the irradiation process of an entire cell population and to repeat the simulation for different values of dose imposed in order to obtain a complete survival curve. For each value of dose imposed the mean value of dose absorbed and cellular survival observed in the population are obtained by calling the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#aac0abf30856195062b94015937838aaf" title="Perform the Monte Carlo simulation relatively to a single value of dose imposed and returns the mean ...">slow_meanDose_meanSurvival_with_Domains()</a> method. Then the survival curve is fitted by means of the <a class="el" href="../../df/d88/namespaceSurvival.html#adcc7f2c138e44c5286663a9c38dd14e1">fit_LQ()</a> method in order to get the LQ parameters. Finally the function returns these parameters with the associated uncertainties by overwriting the correspondent variables passed by reference.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">trackMode</td><td>Defined for completeness. Only "histogram" is supported. </td></tr>
    <tr><td class="paramname">minDose</td><td>The minimum value of dose imposed expressed in Gy. </td></tr>
    <tr><td class="paramname">maxDose</td><td>The maximum value of dose imposed expressed in Gy. </td></tr>
    <tr><td class="paramname">numberOfDoses</td><td>The total number of doses imposed (together with <code>minDose</code> and <code>maxDose</code> this allow to define the sequence). </td></tr>
    <tr><td class="paramname">precision</td><td>Fix the ending condition of the Monte Carlo simulation. </td></tr>
    <tr><td class="paramname">alphaIon</td><td>The LQ <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> parameter expressed in <img class="formulaInl" alt="$Gy^{-1}$" src="../../form_17.png"/>, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">alphaIonUncertainty</td><td>The uncertainty associated to the <img class="formulaInl" alt="$\alpha$" src="../../form_0.png"/> parameter (in <img class="formulaInl" alt="$Gy^{-1}$" src="../../form_17.png"/>), passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">betaIon</td><td>The LQ <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/> parameter expressed in <img class="formulaInl" alt="$Gy^{-2}$" src="../../form_18.png"/>, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">betaIonUncertainty</td><td>The uncertainty associated to the <img class="formulaInl" alt="$\beta$" src="../../form_1.png"/> parameter (in <img class="formulaInl" alt="$Gy^{-2}$" src="../../form_18.png"/>), passed by reference to be overwritten.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>The execution of the program will be terminated if the minimum dose imposed is greater than the maximum one or if an inexistent track mode is selected.</dd>
<dd>
Even if not explicitly required, the nucleus has to be a <a class="el" href="../../d9/d79/classSurvival_1_1Nucleus__MKM.html" title="Inherited from the Nucleus pure virtual class, it implements the cellular nucleus as defined and used...">Nucleus_MKM</a> object.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a71a43500a5655346c3b9ac0f687c999f" title="Method called to perform a Monte Carlo simulation to reproduce the irradiation process getting the LQ...">slow_alphaIon_betaIon()</a> and <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a47538c45fd5a9b2cd97bea6d41341171" title="Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cell...">histogram_dose_survival_with_domains()</a> </dd></dl>

<p>Definition at line <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html#l01017">1017</a> of file <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html">Calculus.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_a5354e680ba838228dba9624b1e0a6ca7_cgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_a5354e680ba838228dba9624b1e0a6ca7_cgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_a5354e680ba838228dba9624b1e0a6ca7_cgraph" id="d3/ddc/classSurvival_1_1Calculus_a5354e680ba838228dba9624b1e0a6ca7_cgraph">
<area shape="rect" id="node2" href="../../d3/ddc/classSurvival_1_1Calculus.html#aac0abf30856195062b94015937838aaf" title="Perform the Monte Carlo simulation relatively to a single value of dose imposed and returns the mean ..." alt="" coords="216,163,429,219"/><area shape="rect" id="node16" href="../../df/d88/namespaceSurvival.html#adcc7f2c138e44c5286663a9c38dd14e1" title="Survival::fit_LQ" alt="" coords="267,243,379,269"/><area shape="rect" id="node3" href="../../d3/d6c/classSurvival_1_1Nucleus.html#aa1ad6b0e5f5152a32cdeb41b68025a93" title="Declaration of the virtual function getNumberOfDomains (for a more detailed description see the deriv..." alt="" coords="489,105,641,146"/><area shape="rect" id="node4" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a31ceca4d57048fde5969a2803be25960" title="Declaration of the pure virtual function getCellType (for a more detailed description see the derived..." alt="" coords="499,170,632,211"/><area shape="rect" id="node5" href="../../d3/ddc/classSurvival_1_1Calculus.html#a47538c45fd5a9b2cd97bea6d41341171" title="Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cell..." alt="" coords="478,235,653,291"/><area shape="rect" id="node6" href="../../dd/d54/classSurvival_1_1Tracks.html#a7f2e0bce46e3142b6bb6329af22a622b" title="Evaluates and returns the mean LET of the vector of tracks, expressed in keV/um. " alt="" coords="702,5,895,32"/><area shape="rect" id="node7" href="../../dd/d54/classSurvival_1_1Tracks.html#a98058ff7f4ff4ebc3eb51a1198bf3015" title="Returns the total weight of the group of particles generating the vector of tracks. " alt="" coords="945,23,1117,65"/><area shape="rect" id="node8" href="../../dd/d54/classSurvival_1_1Tracks.html#ac1a6efb09c4e1eef98ede817db8edcf2" title="Returns the density of the medium in . " alt="" coords="705,107,893,133"/><area shape="rect" id="node9" href="../../d3/d6c/classSurvival_1_1Nucleus.html#aa32471aeb6af3f71a73413d56467a18c" title="Declaration of the pure virtual function getRadius (for a more detailed description see the derived c..." alt="" coords="732,158,865,199"/><area shape="rect" id="node10" href="../../dd/d54/classSurvival_1_1Tracks.html#a4413948ed5fc96621bb0aa8c5f5166d5" title="Returns the size of the vector of tracks. " alt="" coords="724,224,873,251"/><area shape="rect" id="node11" href="../../d3/d4c/classSurvival_1_1Track.html#abd918df6e0738bdf50d908770b809cd8" title="Declaration of the pure virtual function setPosition (for a more detailed description see the derived..." alt="" coords="707,275,890,301"/><area shape="rect" id="node12" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a534c8b9731693f31451a7229a6b7b59f" title="Declaration of the pure virtual function distributeDose (for a more detailed description see the deri..." alt="" coords="732,326,865,367"/><area shape="rect" id="node13" href="../../d3/d6c/classSurvival_1_1Nucleus.html#adbd3faee7029e64620f3dec187657dfe" title="Declaration of the pure virtual function getDoseAndSurvival (for a more detailed description see the ..." alt="" coords="728,391,869,433"/><area shape="rect" id="node14" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a8cc959e4e88632a3fcc49ca20b0f45bc" title="Declaration of the virtual function getDosesandLethals (for a more detailed description see the deriv..." alt="" coords="727,457,870,498"/><area shape="rect" id="node15" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a805a3fbe99df542d135407aa1c2bae28" title="Declaration of the pure virtual function cleanNucleus (for a more detailed description see the derive..." alt="" coords="732,522,865,563"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7362c07d69d46fa313fd2ca68b88de90"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Calculus::slow_meanDose_meanSurvival </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>trackMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>doseImposed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>precision</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>meanDose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>meanDoseUncertainty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>meanSurvival</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>meanSurvivalUncertainty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nFraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>timeSpacing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>fracDeliveryTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>saveCell</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform the Monte Carlo simulation relatively to a single value of dose imposed and returns the mean values of dose absorbed and survival observed in the cell population. </p>
<p>The user has to fix the precision required for the simulation, that is the statistics to be reached to terminate the simulation. Two possibilities are supported, so the user can:</p>
<ul>
<li>Fix the number of iterations, hence the <code>precision</code> has to be an integer value greater (or at least equal) to 1.</li>
<li>Define a constraint on the precision to reach in the simulation in the evaluation of the cell survival (precisely the relative error on the survival), hence the <code>precision</code> has to be a <code>double</code> in (0, 1). Once set the precision desired, the irradiation process of the cell population is simulated by calling the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae5f1ea95674d3f9325cccc91d1469660" title="Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cell...">histogram_dose_survival_p()</a> or the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a294fab8fab79c18b557029728c222150" title="Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cell...">random_dose_survival_p()</a> methods in a parallel loop (or <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#aa500fd3a7915675ca3f53cf16c4374f3" title="Simulates via the Monte Carlo method the irradiation process of a nucleus, which is part of the cellu...">histogram_dose_survival_t()</a> in the case of temporal studies), depending on the trackMode selected (see below). Each thread performs the irradiation of a single cell and at the end of each irradiation the method updates the total mean dose and survival observed, with associated uncertainties, and determines if the precision set by the user is reached or not. All the values of dose and survival obtained, cell by cell, are saved in an output file.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="../../df/d88/namespaceSurvival.html">Survival</a> uncertainty: the estimation of the survival uncertainty is knowingly biased, but extremely efficient and memory-friendly. Note that this quantity is used only to decide when it is possible to stop the simulation hence it doesn't affect the result (and that the bias decrease with increasing iteration).</dd>
<dd>
track mode: this is useful in the case of mixed fields, that is when the field is constituted by different particles. In that case the there are different ways to extract from the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae9cc5cb2e186827348372eeb058890fe" title="A const reference to a Track object corresponding to the Particle interacting with nucleus...">tracks</a> vector the particle to be used event by event:<ul>
<li>If "histogram" is selected then the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae9cc5cb2e186827348372eeb058890fe" title="A const reference to a Track object corresponding to the Particle interacting with nucleus...">tracks</a> vector is interpreted as an histogram where each particle has a specific weight, defined by its frequency in the histogram. Different particle, in this case, are not necessary equiprobable.</li>
<li>If "random" is selected then the different tracks in the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae9cc5cb2e186827348372eeb058890fe" title="A const reference to a Track object corresponding to the Particle interacting with nucleus...">tracks</a> vector are considered equiprobable and a random extraction between them is performed event by event.</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">trackMode</td><td>A <code>string</code> defining the modality to pass the vector of particles in the mixed fields case. The possibilities are "histogram" or "random". </td></tr>
    <tr><td class="paramname">doseImposed</td><td>The value of dose to be delivered in the irradiation, expressed in Gy. </td></tr>
    <tr><td class="paramname">precision</td><td>The precision to be reached in the simulation (could be a fixed number of iterations or a constraint on the survival precision). </td></tr>
    <tr><td class="paramname">meanDose</td><td>The mean value of dose absorbed expressed in Gy, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">meanDoseUncertainty</td><td>The uncertainty on meanDose, expressed in Gy, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">meanSurvival</td><td>The mean value of cellular survival observed, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">meanSurvivalUncertainty</td><td>The uncertainty associated to the mean survival, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">nFraction</td><td>The number of fraction in the case of fractionated treatment. </td></tr>
    <tr><td class="paramname">timeSpacing</td><td>The time spacing between fractions, expressed in hours. </td></tr>
    <tr><td class="paramname">fracDeliveryTime</td><td>The delivery time of each fraction, expressed in hours. </td></tr>
    <tr><td class="paramname">saveCell</td><td>A boolean parameter indicating if the dose-survival data of each cell irradiated are to be saved or not.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>The execution of the program will be terminated if the precision is not set correctly or if an inexistent track mode is selected.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a71a43500a5655346c3b9ac0f687c999f" title="Method called to perform a Monte Carlo simulation to reproduce the irradiation process getting the LQ...">slow_alphaIon_betaIon()</a> </dd></dl>

<p>Definition at line <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html#l01070">1070</a> of file <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html">Calculus.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_a7362c07d69d46fa313fd2ca68b88de90_cgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_a7362c07d69d46fa313fd2ca68b88de90_cgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_a7362c07d69d46fa313fd2ca68b88de90_cgraph" id="d3/ddc/classSurvival_1_1Calculus_a7362c07d69d46fa313fd2ca68b88de90_cgraph">
<area shape="rect" id="node2" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a31ceca4d57048fde5969a2803be25960" title="Declaration of the pure virtual function getCellType (for a more detailed description see the derived..." alt="" coords="295,145,428,186"/><area shape="rect" id="node3" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a4da8e2d8d4a6b805381836f231952fed" title="Declaration of the pure virtual function clone (for a more detailed description see the derived class..." alt="" coords="295,210,428,251"/><area shape="rect" id="node4" href="../../d3/ddc/classSurvival_1_1Calculus.html#a294fab8fab79c18b557029728c222150" title="Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cell..." alt="" coords="274,475,449,517"/><area shape="rect" id="node14" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae5f1ea95674d3f9325cccc91d1469660" title="Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cell..." alt="" coords="267,341,455,382"/><area shape="rect" id="node18" href="../../d3/ddc/classSurvival_1_1Calculus.html#aa500fd3a7915675ca3f53cf16c4374f3" title="Simulates via the Monte Carlo method the irradiation process of a nucleus, which is part of the cellu..." alt="" coords="269,275,454,317"/><area shape="rect" id="node5" href="../../dd/d54/classSurvival_1_1Tracks.html#a4413948ed5fc96621bb0aa8c5f5166d5" title="Returns the size of the vector of tracks. " alt="" coords="527,289,676,316"/><area shape="rect" id="node6" href="../../d3/d6c/classSurvival_1_1Nucleus.html#aa32471aeb6af3f71a73413d56467a18c" title="Declaration of the pure virtual function getRadius (for a more detailed description see the derived c..." alt="" coords="535,391,668,433"/><area shape="rect" id="node7" href="../../dd/d54/classSurvival_1_1Tracks.html#ac1a6efb09c4e1eef98ede817db8edcf2" title="Returns the density of the medium in . " alt="" coords="507,457,695,484"/><area shape="rect" id="node8" href="../../d3/d4c/classSurvival_1_1Track.html#abd918df6e0738bdf50d908770b809cd8" title="Declaration of the pure virtual function setPosition (for a more detailed description see the derived..." alt="" coords="510,508,693,535"/><area shape="rect" id="node9" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a534c8b9731693f31451a7229a6b7b59f" title="Declaration of the pure virtual function distributeDose (for a more detailed description see the deri..." alt="" coords="535,223,668,265"/><area shape="rect" id="node10" href="../../d3/d6c/classSurvival_1_1Nucleus.html#adbd3faee7029e64620f3dec187657dfe" title="Declaration of the pure virtual function getDoseAndSurvival (for a more detailed description see the ..." alt="" coords="531,559,672,601"/><area shape="rect" id="node11" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a44f481a9cf5bc5ab59cc198db0f00ed1" title="Declaration of the pure virtual function getInNucleusCount (for a more detailed description see the d..." alt="" coords="534,690,669,731"/><area shape="rect" id="node12" href="../../d3/d6c/classSurvival_1_1Nucleus.html#ad8fb8b4097f18f7f08920a66759afbb1" title="Declaration of the pure virtual function getIntersectionCount (for a more detailed description see th..." alt="" coords="530,755,673,797"/><area shape="rect" id="node13" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a805a3fbe99df542d135407aa1c2bae28" title="Declaration of the pure virtual function cleanNucleus (for a more detailed description see the derive..." alt="" coords="535,625,668,666"/><area shape="rect" id="node15" href="../../dd/d54/classSurvival_1_1Tracks.html#a7f2e0bce46e3142b6bb6329af22a622b" title="Evaluates and returns the mean LET of the vector of tracks, expressed in keV/um. " alt="" coords="505,121,698,148"/><area shape="rect" id="node16" href="../../dd/d54/classSurvival_1_1Tracks.html#a98058ff7f4ff4ebc3eb51a1198bf3015" title="Returns the total weight of the group of particles generating the vector of tracks. " alt="" coords="747,114,919,155"/><area shape="rect" id="node17" href="../../d3/d4c/classSurvival_1_1Track.html#a5dcb85c3c1363c6166a46435308a6bd1" title="Declaration of the pure virtual function setTime (for a more detailed description see the derived cla..." alt="" coords="519,172,684,199"/><area shape="rect" id="node19" href="../../d3/ddc/classSurvival_1_1Calculus.html#aa3f0e540feb07414181a3ddc9a5dc289" title="Generate an ordered fixed&#45;size sequence of pseudorandom numbers in [begin, begin+duration]. " alt="" coords="532,5,671,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_a7362c07d69d46fa313fd2ca68b88de90_icgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_a7362c07d69d46fa313fd2ca68b88de90_icgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_a7362c07d69d46fa313fd2ca68b88de90_icgraph" id="d3/ddc/classSurvival_1_1Calculus_a7362c07d69d46fa313fd2ca68b88de90_icgraph">
<area shape="rect" id="node2" href="../../d3/ddc/classSurvival_1_1Calculus.html#a71a43500a5655346c3b9ac0f687c999f" title="Method called to perform a Monte Carlo simulation to reproduce the irradiation process getting the LQ..." alt="" coords="267,5,429,46"/><area shape="rect" id="node3" href="../../df/d0a/main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="477,12,528,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aac0abf30856195062b94015937838aaf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Calculus::slow_meanDose_meanSurvival_with_Domains </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>trackMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>doseImposed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>precision</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>meanDose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>meanDoseUncertainty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>meanSurvival</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>meanSurvivalUncertainty</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform the Monte Carlo simulation relatively to a single value of dose imposed and returns the mean values of dose absorbed and survival observed in the cell population. This function was thought to control the dose delivery inside the MKM nucleus. It's similar to <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a7362c07d69d46fa313fd2ca68b88de90" title="Perform the Monte Carlo simulation relatively to a single value of dose imposed and returns the mean ...">slow_meanDose_meanSurvival()</a> but provide also informations on the microscopic dose deposition pattern in each domain of the nucleus. </p>
<p>The user has to fix the precision required for the simulation, that is the statistics to be reached to terminate the simulation. Two possibilities are supported, so the user can:</p>
<ul>
<li>Fix the number of iterations, hence the <code>precision</code> has to be an integer value greater (or at least equal) to 1.</li>
<li>Define a constraint on the precision to reach in the simulation in the evaluation of the cell survival (precisely the relative error on the survival), hence the <code>precision</code> has to be a <code>double</code> in (0, 1). Once set the precision desired, the irradiation process of the cell population is simulated by calling the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a47538c45fd5a9b2cd97bea6d41341171" title="Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cell...">histogram_dose_survival_with_domains()</a> method in a loop that, in each iteration, performs the irradiation of a single cell. At the end of the irradiation, the method updates the total mean dose and survival observed, with associated uncertainties, and determines if the precision set by the user is reached or not. All the values of dose and survival obtained, cell by cell, are saved in an output file together with the total number of lethal events observed in the nucleus.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="../../df/d88/namespaceSurvival.html">Survival</a> uncertainty: the estimation of the survival uncertainty is knowingly biased, but extremely efficient and memory-friendly. Note that this quantity is used only to decide when it is possible to stop the simulation hence it doesn't affect the result (and that the bias decrease with increasing iteration).</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">trackMode</td><td>Defined for completeness. Only "histogram" is supported. </td></tr>
    <tr><td class="paramname">doseImposed</td><td>The value of dose to be delivered in the irradiation, expressed in Gy. </td></tr>
    <tr><td class="paramname">precision</td><td>The precision to be reached in the simulation (could be a fixed number of iterations or a constraint on the survival precision). </td></tr>
    <tr><td class="paramname">meanDose</td><td>The mean value of dose absorbed expressed in Gy, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">meanDoseUncertainty</td><td>The uncertainty on meanDose, expressed in Gy, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">meanSurvival</td><td>The mean value of cellular survival observed, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">meanSurvivalUncertainty</td><td>The uncertainty associated to the mean survival, passed by reference to be overwritten.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>The execution of the program will be terminated if the precision is not set correctly or if an inexistent track mode is selected.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a71a43500a5655346c3b9ac0f687c999f" title="Method called to perform a Monte Carlo simulation to reproduce the irradiation process getting the LQ...">slow_alphaIon_betaIon()</a> and <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a5354e680ba838228dba9624b1e0a6ca7" title="This function was thought to control the dose delivery inside the MKM nucleus. It&#39;s similar to slow_a...">slow_alphaIon_betaIon_with_Domains()</a> </dd></dl>

<p>Definition at line <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html#l01229">1229</a> of file <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html">Calculus.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_aac0abf30856195062b94015937838aaf_cgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_aac0abf30856195062b94015937838aaf_cgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_aac0abf30856195062b94015937838aaf_cgraph" id="d3/ddc/classSurvival_1_1Calculus_aac0abf30856195062b94015937838aaf_cgraph">
<area shape="rect" id="node2" href="../../d3/d6c/classSurvival_1_1Nucleus.html#aa1ad6b0e5f5152a32cdeb41b68025a93" title="Declaration of the virtual function getNumberOfDomains (for a more detailed description see the deriv..." alt="" coords="279,105,431,146"/><area shape="rect" id="node3" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a31ceca4d57048fde5969a2803be25960" title="Declaration of the pure virtual function getCellType (for a more detailed description see the derived..." alt="" coords="288,170,421,211"/><area shape="rect" id="node4" href="../../d3/ddc/classSurvival_1_1Calculus.html#a47538c45fd5a9b2cd97bea6d41341171" title="Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cell..." alt="" coords="267,235,442,291"/><area shape="rect" id="node5" href="../../dd/d54/classSurvival_1_1Tracks.html#a7f2e0bce46e3142b6bb6329af22a622b" title="Evaluates and returns the mean LET of the vector of tracks, expressed in keV/um. " alt="" coords="491,5,685,32"/><area shape="rect" id="node6" href="../../dd/d54/classSurvival_1_1Tracks.html#a98058ff7f4ff4ebc3eb51a1198bf3015" title="Returns the total weight of the group of particles generating the vector of tracks. " alt="" coords="734,23,906,65"/><area shape="rect" id="node7" href="../../dd/d54/classSurvival_1_1Tracks.html#ac1a6efb09c4e1eef98ede817db8edcf2" title="Returns the density of the medium in . " alt="" coords="494,107,682,133"/><area shape="rect" id="node8" href="../../d3/d6c/classSurvival_1_1Nucleus.html#aa32471aeb6af3f71a73413d56467a18c" title="Declaration of the pure virtual function getRadius (for a more detailed description see the derived c..." alt="" coords="521,158,655,199"/><area shape="rect" id="node9" href="../../dd/d54/classSurvival_1_1Tracks.html#a4413948ed5fc96621bb0aa8c5f5166d5" title="Returns the size of the vector of tracks. " alt="" coords="513,224,663,251"/><area shape="rect" id="node10" href="../../d3/d4c/classSurvival_1_1Track.html#abd918df6e0738bdf50d908770b809cd8" title="Declaration of the pure virtual function setPosition (for a more detailed description see the derived..." alt="" coords="497,275,679,301"/><area shape="rect" id="node11" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a534c8b9731693f31451a7229a6b7b59f" title="Declaration of the pure virtual function distributeDose (for a more detailed description see the deri..." alt="" coords="521,326,655,367"/><area shape="rect" id="node12" href="../../d3/d6c/classSurvival_1_1Nucleus.html#adbd3faee7029e64620f3dec187657dfe" title="Declaration of the pure virtual function getDoseAndSurvival (for a more detailed description see the ..." alt="" coords="517,391,659,433"/><area shape="rect" id="node13" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a8cc959e4e88632a3fcc49ca20b0f45bc" title="Declaration of the virtual function getDosesandLethals (for a more detailed description see the deriv..." alt="" coords="517,457,659,498"/><area shape="rect" id="node14" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a805a3fbe99df542d135407aa1c2bae28" title="Declaration of the pure virtual function cleanNucleus (for a more detailed description see the derive..." alt="" coords="521,522,655,563"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_aac0abf30856195062b94015937838aaf_icgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_aac0abf30856195062b94015937838aaf_icgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_aac0abf30856195062b94015937838aaf_icgraph" id="d3/ddc/classSurvival_1_1Calculus_aac0abf30856195062b94015937838aaf_icgraph">
<area shape="rect" id="node2" href="../../d3/ddc/classSurvival_1_1Calculus.html#a5354e680ba838228dba9624b1e0a6ca7" title="This function was thought to control the dose delivery inside the MKM nucleus. It&#39;s similar to slow_a..." alt="" coords="267,4,429,60"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1303a07d2edc29d56b313eeac9c16a62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Calculus::verbatim_dose_survival </td>
          <td>(</td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>dose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>doseUncertainty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>survival</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>survivalUncertainty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>clean</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluates the dose deposited in the nucleus using directly the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae9cc5cb2e186827348372eeb058890fe" title="A const reference to a Track object corresponding to the Particle interacting with nucleus...">tracks</a> vector without modifying it and without random numbers extractions. </p>
<p>It simply calls the Nucleus::distributeDose(const Tracks) method passing the <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae9cc5cb2e186827348372eeb058890fe" title="A const reference to a Track object corresponding to the Particle interacting with nucleus...">tracks</a> vector and then it gets informations on dose deposited and survival observed, with associated uncertainties, via the <a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html#adbd3faee7029e64620f3dec187657dfe" title="Declaration of the pure virtual function getDoseAndSurvival (for a more detailed description see the ...">Nucleus::getDoseAndSurvival()</a> method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dose</td><td>The dose absorbed by the nucleus in the irradiation, expressed in Gy, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">doseUncertainty</td><td>The uncertainty associated to the dose absorbed, expressed in Gy, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">survival</td><td>The cellular survival observed, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">survivalUncertainty</td><td>The uncertainty associated to the cellular survival, passed by reference to be overwritten. </td></tr>
    <tr><td class="paramname">clean</td><td>A boolean value indicating if the nucleus has to be cleaned at the end of the evaluation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>It's actually unused.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#ae5f1ea95674d3f9325cccc91d1469660" title="Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cell...">histogram_dose_survival_p()</a> and <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a294fab8fab79c18b557029728c222150" title="Simulates, via the Monte Carlo method, the irradiation process of a nucleus which is part of the cell...">random_dose_survival_p()</a> </dd></dl>

<p>Definition at line <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html#l01329">1329</a> of file <a class="el" href="../../d4/d1f/Calculus_8cpp_source.html">Calculus.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/classSurvival_1_1Calculus_a1303a07d2edc29d56b313eeac9c16a62_cgraph.png" border="0" usemap="#d3/ddc/classSurvival_1_1Calculus_a1303a07d2edc29d56b313eeac9c16a62_cgraph" alt=""/></div>
<map name="d3/ddc/classSurvival_1_1Calculus_a1303a07d2edc29d56b313eeac9c16a62_cgraph" id="d3/ddc/classSurvival_1_1Calculus_a1303a07d2edc29d56b313eeac9c16a62_cgraph">
<area shape="rect" id="node2" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a534c8b9731693f31451a7229a6b7b59f" title="Declaration of the pure virtual function distributeDose (for a more detailed description see the deri..." alt="" coords="227,5,360,46"/><area shape="rect" id="node3" href="../../d3/d6c/classSurvival_1_1Nucleus.html#adbd3faee7029e64620f3dec187657dfe" title="Declaration of the pure virtual function getDoseAndSurvival (for a more detailed description see the ..." alt="" coords="223,70,364,111"/><area shape="rect" id="node4" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a44f481a9cf5bc5ab59cc198db0f00ed1" title="Declaration of the pure virtual function getInNucleusCount (for a more detailed description see the d..." alt="" coords="226,135,361,177"/><area shape="rect" id="node5" href="../../d3/d6c/classSurvival_1_1Nucleus.html#ad8fb8b4097f18f7f08920a66759afbb1" title="Declaration of the pure virtual function getIntersectionCount (for a more detailed description see th..." alt="" coords="222,201,365,242"/><area shape="rect" id="node6" href="../../d3/d6c/classSurvival_1_1Nucleus.html#a805a3fbe99df542d135407aa1c2bae28" title="Declaration of the pure virtual function cleanNucleus (for a more detailed description see the derive..." alt="" coords="227,266,360,307"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a77c5837150fee7a4e02a26d301df8564"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d3/d56/classSurvival_1_1CellLine.html">CellLine</a>&amp; Survival::Calculus::cellLine</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A <code>const</code> reference to a <a class="el" href="../../d3/d56/classSurvival_1_1CellLine.html" title="Represents the cell line to which the nucleus belongs and hosts the radiobiological and structural ch...">CellLine</a> object corresponding to the cell line to which the nucleus belongs. </p>

<p>Definition at line <a class="el" href="../../d3/de2/Calculus_8h_source.html#l00597">597</a> of file <a class="el" href="../../d3/de2/Calculus_8h_source.html">Calculus.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3bc1ee3d082af310885da70c38f1f69a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string Survival::Calculus::model</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The model used in the simulation. </p>

<p>Definition at line <a class="el" href="../../d3/de2/Calculus_8h_source.html#l00618">618</a> of file <a class="el" href="../../d3/de2/Calculus_8h_source.html">Calculus.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3ffcf267836a8c9427b0b1012d3fb9e6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Survival::Calculus::nThreads</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The number of threads needed to be used in the simulation (if parallelism is supported). </p>
<p>Possible cases are:</p>
<ul>
<li>0: Uses a number of threads corresponding to the number of core of the machine executing this program.</li>
<li>1: Uses 1 threads, i.e. Disabled multithread</li>
<li>A number greater than 1: Specifies the exact number of threads. </li>
</ul>

<p>Definition at line <a class="el" href="../../d3/de2/Calculus_8h_source.html#l00609">609</a> of file <a class="el" href="../../d3/de2/Calculus_8h_source.html">Calculus.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3960e65eb18f7c3239b8cfe9cd877cf3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d3/d6c/classSurvival_1_1Nucleus.html">Nucleus</a>&amp; Survival::Calculus::nucleus</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A reference to the cellular nucleus. </p>

<p>Definition at line <a class="el" href="../../d3/de2/Calculus_8h_source.html#l00600">600</a> of file <a class="el" href="../../d3/de2/Calculus_8h_source.html">Calculus.h</a>.</p>

</div>
</div>
<a class="anchor" id="a52368f19965750ec6eedd7a5eb6e3967"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gsl_rng* Survival::Calculus::randomGenerator</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A pointer to a gsl_rng object, useful in the generation of pseudorandom numbers in the Monte Carlo simulation. </p>

<p>Definition at line <a class="el" href="../../d3/de2/Calculus_8h_source.html#l00612">612</a> of file <a class="el" href="../../d3/de2/Calculus_8h_source.html">Calculus.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae41fc7fc62ad55b23e6c956243af265a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string Survival::Calculus::savePrefix</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The prefix of the output file. </p>

<p>Definition at line <a class="el" href="../../d3/de2/Calculus_8h_source.html#l00615">615</a> of file <a class="el" href="../../d3/de2/Calculus_8h_source.html">Calculus.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae9cc5cb2e186827348372eeb058890fe"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../dd/d54/classSurvival_1_1Tracks.html">Tracks</a>&amp; Survival::Calculus::tracks</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A <code>const</code> reference to a <a class="el" href="../../d3/d4c/classSurvival_1_1Track.html" title="Constructed on the base of an ion Particle object, this class represents the local dose distribution ...">Track</a> object corresponding to the <a class="el" href="../../d3/d2a/classSurvival_1_1Particle.html" title="This class defines the object &quot;particle&quot;. ">Particle</a> interacting with <a class="el" href="../../d3/ddc/classSurvival_1_1Calculus.html#a3960e65eb18f7c3239b8cfe9cd877cf3" title="A reference to the cellular nucleus. ">nucleus</a>. </p>

<p>Definition at line <a class="el" href="../../d3/de2/Calculus_8h_source.html#l00594">594</a> of file <a class="el" href="../../d3/de2/Calculus_8h_source.html">Calculus.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="../../d3/de2/Calculus_8h_source.html">Calculus.h</a></li>
<li>src/<a class="el" href="../../d4/d1f/Calculus_8cpp_source.html">Calculus.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Apr 14 2016 11:05:38 for “Survival” by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
